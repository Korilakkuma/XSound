!function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var r={};e.m=t,e.c=r,e.d=function(t,r,i){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.isActive=!0,this.context=e,this.input=e.createGain(),this.output=e.createGain(),this.lfo=e.createOscillator(),this.depth=e.createGain(),this.rate=this.lfo.frequency,this.processor=e.createScriptProcessor(r,1,2),this.lfo.start=this.lfo.start||this.lfo.noteOn,this.lfo.stop=this.lfo.stop||this.lfo.noteOff,this.values={},this.isStop=!0}return i(t,[{key:"param",value:function(){}},{key:"connect",value:function(){}},{key:"start",value:function(t){if(this.isActive&&this.isStop){var e=parseFloat(t);(isNaN(e)||e<this.context.currentTime)&&(e=this.context.currentTime),this.lfo.start(e),this.isStop=!1}return this}},{key:"stop",value:function(t,e){if(this.isActive&&!this.isStop){var r=parseFloat(t),i=parseFloat(e);(isNaN(r)||r<this.context.currentTime)&&(r=this.context.currentTime),(isNaN(i)||i<0)&&(i=0);var n=this.lfo.type,s=this.lfo.frequency.value;this.lfo.stop(r+i),this.lfo=this.context.createOscillator(),this.lfo.start=this.lfo.start||this.lfo.noteOn,this.lfo.stop=this.lfo.stop||this.lfo.noteOff,this.lfo.type=n,this.lfo.frequency.value=s,this.rate=this.lfo.frequency,this.isStop=!0}return this}},{key:"state",value:function(t){return void 0===t?this.isActive:("toggle"===String(t).toLowerCase()?this.isActive=!this.isActive:this.isActive=Boolean(t),this.connect(),this.start(this.context.currentTime),this)}},{key:"params",value:function(){return{}}},{key:"toJSON",value:function(){return JSON.stringify(this.params())}},{key:"toString",value:function(){return"[SoundModule Effector]"}}]),t}();e.default=n},function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),s=i(r(9)),a=i(r(13)),o=i(r(14)),l=i(r(15)),u=i(r(16)),c=i(r(17)),f=i(r(18)),h=i(r(19)),p=i(r(20)),y=i(r(21)),d=i(r(22)),v=i(r(23)),b=i(r(24)),m=i(r(25)),g=i(r(26)),w=i(r(27)),O=i(r(28)),S=i(r(29)),A=i(r(30)),k=i(r(31)),_=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e,this.sampleRate=e.sampleRate;var i=navigator.userAgent;if(void 0!==r)switch(parseInt(r,10)){case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:this.bufferSize=parseInt(r,10);break;default:return}else/(Win(dows )?NT 6\.2)/.test(i)?this.bufferSize=1024:/(Win(dows )?NT 6\.1)/.test(i)?this.bufferSize=1024:/(Win(dows )?NT 6\.0)/.test(i)?this.bufferSize=2048:/Win(dows )?(NT 5\.1|XP)/.test(i)?this.bufferSize=4096:/Mac|PPC/.test(i)?this.bufferSize=1024:/Linux/.test(i)?this.bufferSize=8192:/iPhone|iPad|iPod/.test(i)?this.bufferSize=2048:this.bufferSize=16384;this.mastervolume=e.createGain(),this.processor=e.createScriptProcessor(this.bufferSize,t.NUMBER_OF_INPUTS,t.NUMBER_OF_OUTPUTS),this.analyser=new s.default(e),this.recorder=new a.default(e,this.bufferSize,t.NUMBER_OF_INPUTS,t.NUMBER_OF_OUTPUTS),this.session=new o.default(e,this.bufferSize,t.NUMBER_OF_INPUTS,t.NUMBER_OF_OUTPUTS,this.analyser),this.compressor=new l.default(e,this.bufferSize),this.distortion=new u.default(e,this.bufferSize),this.wah=new c.default(e,this.bufferSize),this.equalizer=new f.default(e,this.bufferSize),this.filter=new h.default(e,this.bufferSize),this.autopanner=e.createStereoPanner?new p.default(e,this.bufferSize):new y.default(e,this.bufferSize),this.tremolo=new d.default(e,this.bufferSize),this.ringmodulator=new v.default(e,this.bufferSize),this.phaser=new b.default(e,this.bufferSize),this.flanger=new m.default(e,this.bufferSize),this.chorus=new g.default(e,this.bufferSize),this.delay=new w.default(e,this.bufferSize),this.reverb=new O.default(e,this.bufferSize),this.panner=new S.default(e,this.bufferSize),this.listener=new A.default(e),this.envelopegenerator=new k.default(e),this.modules=[this.compressor,this.distortion,this.wah,this.equalizer,this.filter,this.autopanner,this.tremolo,this.ringmodulator,this.phaser,this.flanger,this.chorus,this.delay,this.reverb,this.panner]}return n(t,[{key:"setup",value:function(){}},{key:"param",value:function(t,e){var r=null,i=null;switch(String(t).replace(/-/g,"").toLowerCase()){case"mastervolume":if(void 0===e)return this.mastervolume.gain.value;i=1,(r=parseFloat(e))>=0&&r<=i&&(this.mastervolume.gain.value=r)}}},{key:"ready",value:function(){}},{key:"start",value:function(){}},{key:"stop",value:function(){}},{key:"get",value:function(){}},{key:"resize",value:function(e){return this.processor=this.context.createScriptProcessor(e,t.NUMBER_OF_INPUTS,t.NUMBER_OF_OUTPUTS),this}},{key:"getBufferSize",value:function(){return this.processor.bufferSize}},{key:"connect",value:function(t,e){Array.isArray(e)&&(this.modules=e),t.disconnect(0),this.modules.length>0?t.connect(this.modules[0].input):t.connect(this.mastervolume);for(var r=0,i=this.modules.length;r<i;r++)this.modules[r].output.disconnect(0),r<this.modules.length-1?this.modules[r].output.connect(this.modules[r+1].input):this.modules[r].output.connect(this.mastervolume);return this.mastervolume.connect(this.context.destination),this.mastervolume.connect(this.analyser.input),this.mastervolume.connect(this.recorder.processor),this.recorder.processor.connect(this.context.destination),this.mastervolume.connect(this.session.sender),this.session.sender.connect(this.context.destination),this}},{key:"module",value:function(t){var e=String(t).replace(/-/g,"").toLowerCase();switch(e){case"analyser":case"recorder":case"session":case"compressor":case"distortion":case"wah":case"equalizer":case"filter":case"autopanner":case"tremolo":case"ringmodulator":case"phaser":case"flanger":case"chorus":case"delay":case"reverb":case"panner":case"listener":return this[e];case"envelopegenerator":case"eg":return this.envelopegenerator;case"glide":if(e in this)return this[e];case"vocalcanceler":if(e in this)return this[e];case"noisegate":if(e in this)return this[e]}}},{key:"on",value:function(t){var e=parseFloat(t);return(isNaN(e)||e<this.context.currentTime)&&(e=this.context.currentTime),this.chorus.start(e),this.flanger.start(e),this.phaser.start(e),this.autopanner.start(e),this.tremolo.start(e),this.ringmodulator.start(e),this.wah.start(e),this.filter.start(e),this}},{key:"off",value:function(t){var e=parseFloat(t);return(isNaN(e)||e<this.context.currentTime)&&(e=this.context.currentTime),this.chorus.stop(e),this.flanger.stop(e),this.phaser.stop(e),this.autopanner.stop(e),this.tremolo.stop(e),this.ringmodulator.stop(e),this.wah.stop(e),this}},{key:"params",value:function(){var t={};for(var e in this)if("[object Function]"!==Object.prototype.toString.call(this[e])){var r=e.toLowerCase();"mastervolume"===r?t[r]=this[e].gain.value:"[object Object]"===Object.prototype.toString.call(this[e])&&"params"in this[e]&&(t[r]=this[e].params())}return t}},{key:"toJSON",value:function(){return JSON.stringify(this.params())}},{key:"toString",value:function(){return"[SoundModule]"}}]),t}();_.NUMBER_OF_INPUTS=2,_.NUMBER_OF_OUTPUTS=2,e.default=_},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sampleRate=e,this.isActive=!1,this.graphics="",this.canvas=null,this.context=null,this.svg=null,this.interval=1e3,this.timerid=null,this.styles={shape:"line",grad:[{offset:0,color:"rgba(0, 128, 255, 1.0)"},{offset:1,color:"rgba(0, 0, 255, 1.0)"}],wave:"rgba(0, 0, 255, 1.0)",grid:"rgba(255, 0, 0, 1.0)",text:"rgba(255, 255, 255, 1.0)",font:{family:"Arial",size:"13px",style:"normal",weight:"normal"},width:1.5,cap:"round",join:"miter",top:15,right:30,bottom:15,left:30}}return i(t,[{key:"setup",value:function(e){return e instanceof HTMLCanvasElement?(this.graphics=t.CANVAS,this.canvas=e,this.context=this.canvas.getContext("2d")):e instanceof SVGElement&&(this.graphics=t.SVG,this.svg=e,this.svg.setAttribute("xmlns",t.XMLNS),this.svg.setAttribute("xmlns:xlink",t.XLINK)),this}},{key:"param",value:function(t,e){var r=String(t).replace(/-/g,"").toLowerCase(),i=null;switch(r){case"interval":if(void 0===e)return this.interval;"auto"===String(e).toLowerCase()?this.interval="auto":(i=parseFloat(e))>=0&&(this.interval=i);break;case"shape":if(void 0===e)return this.styles.shape;"line"!==(i=String(e).toLowerCase())&&"rect"!==i||(this.styles.shape="gradient"!==this.styles.wave?i:"rect");break;case"grad":if(void 0===e)return this.styles.grad;Array.isArray(e)||(e=[e]);var n=!1,s=!0,a=!1,o=void 0;try{for(var l,u=e[Symbol.iterator]();!(s=(l=u.next()).done);s=!0){var c=l.value;if(!("offset"in c&&"color"in c)){n=!0;break}var f=parseFloat(c.offset);if(isNaN(f)||f<0||f>1){n=!0;break}}}catch(t){a=!0,o=t}finally{try{!s&&u.return&&u.return()}finally{if(a)throw o}}n||(this.styles.grad=e);break;case"font":if(void 0===e)return this.styles[r];if("[object Object]"===Object.prototype.toString.call(e))for(var h in e)/family|size|style|weight/i.test(h)&&(this.styles.font[h]=String(e[h]));break;case"wave":case"grid":case"text":case"cap":case"join":if(void 0===e)return this.styles[r];"string"==typeof e&&("wave"===r&&"gradient"===e&&(this.styles.shape="rect"),this.styles[r]=e.toLowerCase());break;case"width":case"top":case"right":case"bottom":case"left":if(void 0===e)return this.styles[r];(i="width"===r?parseFloat(e):parseInt(e,10))>=0&&(this.styles[r]=i)}}},{key:"start",value:function(e,r,i){switch(this.graphics){case t.CANVAS:this.drawOnCanvas(e,r,i);break;case t.SVG:this.drawBySVG(e,r,i)}return this}},{key:"create",value:function(){switch(this.graphics){case t.CANVAS:return this.canvas.toDataURL("image/png").replace("image/png","image/octet-stream");case t.SVG:return this.svg.outerHTML;default:return this}}},{key:"state",value:function(t){return void 0===t?this.isActive:("toggle"===String(t).toLowerCase()?this.isActive=!this.isActive:this.isActive=Boolean(t),this)}},{key:"drawTimeDomainFloat32ArrayOnCanvas",value:function(t,e,r,i,n,s){if(!(t instanceof CanvasRenderingContext2D))return this;if(!(e instanceof Float32Array))return this;var a=parseInt(r,10),o=parseInt(i,10),l=parseInt(n,10);switch(isNaN(a)&&(a=0),isNaN(o)&&(o=0),isNaN(l)&&(l=0),this.styles.shape){case"line":t.strokeStyle=this.styles.wave,t.lineWidth=this.styles.width,t.lineCap=this.styles.cap,t.lineJoin=this.styles.join,t.beginPath();for(var u=0,c=e.length;u<c;u++)if(null===s||void 0===s||u%s==0){var f=Math.floor(u/c*a)+this.styles.left,h=Math.floor((1-e[u])*(o/2))+this.styles.top;0===u?t.moveTo(f+this.styles.width/2,h):t.lineTo(f,h)}t.stroke();break;case"rect":"gradient"!==this.styles.wave&&(t.fillStyle=this.styles.wave);for(var p=0,y=e.length;p<y;p++)if(null===s||void 0===s||p%s==0){var d=Math.floor(p/y*a)+this.styles.left,v=-1*Math.floor(e[p]*(o/2));if("gradient"===this.styles.wave){var b=i/2+this.styles.top,m=t.createLinearGradient(0,b,0,b+v),g=!0,w=!1,O=void 0;try{for(var S,A=this.styles.grad[Symbol.iterator]();!(g=(S=A.next()).done);g=!0){var k=S.value;m.addColorStop(k.offset,k.color)}}catch(t){w=!0,O=t}finally{try{!g&&A.return&&A.return()}finally{if(w)throw O}}t.fillStyle=m}t.fillRect(d,l,this.styles.width,v)}}return this}},{key:"drawTimeDomainFloat32ArrayBySVG",value:function(e,r,i,n,s,a){var o=parseInt(r,10),l=parseInt(i,10),u=parseInt(n,10);switch(isNaN(o)&&(o=0),isNaN(l)&&(l=0),isNaN(u)&&(u=0),this.styles.shape){case"line":for(var c=document.createElementNS(t.XMLNS,"path"),f="",h=0,p=e.length;h<p;h++)if(null===s||void 0===s||h%s==0){var y=Math.floor(h/p*o)+this.styles.left,d=Math.floor((1-e[h])*(l/2))+this.styles.top;f+=0===h?"M"+(y+this.styles.width/2)+" "+d:" L"+y+" "+d}return c.setAttribute("d",f),c.setAttribute("stroke",this.styles.wave),c.setAttribute("fill","none"),c.setAttribute("stroke-width",this.styles.width),c.setAttribute("stroke-linecap",this.styles.cap),c.setAttribute("stroke-linejoin",this.styles.join),c;case"rect":var v=null;"gradient"===this.styles.wave&&(v=this.createSVGLinearGradient(a));var b=document.createElementNS(t.XMLNS,"g");null!==v&&b.appendChild(v);for(var m=0,g=e.length;m<g;m++)if(null===s||void 0===s||m%s==0){var w=document.createElementNS(t.XMLNS,"rect"),O=Math.floor(m/g*o)+this.styles.left,S=Math.floor(e[m]*(i/2));w.setAttribute("x",O),w.setAttribute("y",u),w.setAttribute("width",this.styles.width),S<0?w.setAttribute("height",-S):(w.setAttribute("height",S),w.setAttribute("transform","rotate(180 "+(O+this.styles.width/2)+" "+u+")")),w.setAttribute("stroke","none"),w.setAttribute("fill",null===v?this.styles.wave:"url(#"+a+")"),b.appendChild(w)}return b;default:return null}}},{key:"createSVGLinearGradient",value:function(e){var r=document.createElementNS(t.XMLNS,"defs"),i=document.createElementNS(t.XMLNS,"linearGradient");i.setAttribute("id",String(e)),i.setAttribute("x1","0%"),i.setAttribute("y1","0%"),i.setAttribute("x2","0%"),i.setAttribute("y2","100%");var n=!0,s=!1,a=void 0;try{for(var o,l=this.styles.grad[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var u=o.value,c=document.createElementNS(t.XMLNS,"stop");c.setAttribute("offset",u.offset),c.setAttribute("stop-color",u.color),i.appendChild(c)}}catch(t){s=!0,a=t}finally{try{!n&&l.return&&l.return()}finally{if(s)throw a}}return r.appendChild(i),r}},{key:"createFontString",value:function(){var t=this.styles.font;return t.size+" "+t.style+" "+t.weight+' "'+t.family+'"'}},{key:"drawOnCanvas",value:function(){}},{key:"drawBySVG",value:function(){}},{key:"toString",value:function(){return"[SoundModule Analyser Visualizer]"}}]),t}();n.CANVAS="canvas",n.SVG="svg",n.XMLNS="http://www.w3.org/2000/svg",n.XLINK="http://www.w3.org/1999/xlink",n.SVG_LINEAR_GRADIENT_ID_TIME_OVERVIEW="svg-linear-gradient-time-overview",n.SVG_LINEAR_GRADIENT_ID_TIME="svg-linear-gradient-time",n.SVG_LINEAR_GRADIENT_ID_FFT="svg-linear-gradient-fft",e.default=n},function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),s=function t(e,r,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,r);if(void 0===n){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)},a=i(r(1)),o=i(r(32)),l=i(r(33)),u=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.sources=[],r.times={start:0,stop:0},r.isAnalyser=!1,r.glide=new l.default(t),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),n(e,[{key:"setup",value:function(t){this.sources.length=0,Array.isArray(t)||(t=[t]);for(var e=0,r=t.length;e<r;e++)this.sources[e]=new o.default(this.context,Boolean(t[e])),this.envelopegenerator.setGenerator(e);return this}},{key:"param",value:function(t,r){if("[object Object]"!==Object.prototype.toString.call(arguments[0])){var i=String(t).replace(/-/g,"").toLowerCase(),n=s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"param",this).call(this,i,r);return void 0===n?this:n}for(var a in arguments[0])this.param(a,arguments[0][a])}},{key:"ready",value:function(t,e){var r=parseFloat(t),i=parseFloat(e);return this.times.start=r>=0?r:0,this.times.stop=i>=r?i:0,this.envelopegenerator.clear(!0),this}},{key:"start",value:function(t,e,r){var i=this,n=this.context.currentTime+this.times.start;Array.isArray(t)||(t=[t]);for(var s=0,a=t.length;s<a;s++){var o=parseFloat(t[s]);t[s]=o>=0?o:0}this.envelopegenerator.clear(!0),this.processor.disconnect(0),this.processor.onaudioprocess=null,this.connect(this.processor,e);for(var l=0,u=t.length;l<u&&!(l>=this.sources.length);l++){var c=this.sources[l],f=t[l];c.ready(this.processor),this.envelopegenerator.ready(l,c.source,c.volume),this.glide.ready(f).start(c.source,n),c.start(n)}return this.envelopegenerator.start(n),this.on(n),this.isAnalyser||(this.analyser.start("time"),this.analyser.start("fft"),this.isAnalyser=!0),"[object Function]"===Object.prototype.toString.call(r)?this.processor.onaudioprocess=r:this.processor.onaudioprocess=function(t){var e=t.inputBuffer.getChannelData(0),r=t.inputBuffer.getChannelData(1),n=t.outputBuffer.getChannelData(0),s=t.outputBuffer.getChannelData(1);if(i.envelopegenerator.isStop()){var a=i.context.currentTime,o=!0,l=!1,u=void 0;try{for(var c,f=i.sources[Symbol.iterator]();!(o=(c=f.next()).done);o=!0){c.value.stop(a)}}catch(t){l=!0,u=t}finally{try{!o&&f.return&&f.return()}finally{if(l)throw u}}i.off(a),i.analyser.stop("time"),i.analyser.stop("fft"),i.isAnalyser=!1,i.processor.disconnect(0),i.processor.onaudioprocess=null}else n.set(e),s.set(r)},this}},{key:"stop",value:function(){var t=this.context.currentTime+this.times.stop;return this.envelopegenerator.stop(t),this.glide.stop(),this.filter.stop(t),this}},{key:"get",value:function(t){var e=parseInt(t,10);return e>=0&&e<this.sources.length?this.sources[e]:this.sources}},{key:"length",value:function(){return this.sources.length}},{key:"params",value:function(){var t=s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"params",this).call(this);t.oscillator={glide:{type:this.glide.param("type"),time:this.glide.param("time")}};for(var r=0,i=this.sources.length;r<i;r++){var n=this.sources[r];t.oscillator["oscillator"+r]={state:n.state(),gain:n.param("gain"),type:n.param("type"),octave:n.param("octave"),fine:n.param("fine")}}return t}},{key:"toString",value:function(){return"[OscillatorModule]"}}]),e}();e.default=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function t(e,r,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,r);if(void 0===n){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)},s=function(t){return t&&t.__esModule?t:{default:t}}(r(1)),a=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.sources=[],r.resources=[],r.buffers=[],r.volumes=[],r.isStops=[],r.settings=[],r.times={start:0,stop:0},r.transpose=1,r.isStop=!0,r.isAnalyser=!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),i(e,[{key:"setup",value:function(t,r,i,n,s,a){var o=this;if("[object Object]"===Object.prototype.toString.call(arguments[0])){var l=arguments[0];"resources"in l&&(t=l.resources),"settings"in l&&(r=l.settings),"timeout"in l&&(i=l.timeout),"success"in l&&(n=l.success),"error"in l&&(s=l.error),"progress"in l&&(a=l.progress)}Array.isArray(t)||(t=[t]),this.resources=t,Array.isArray(r)||(r=[r]),this.buffers.length=t.length;for(var u=0,c=r.length;u<c;u++){if(!("buffer"in r[u]))return;var f=parseInt(r[u].buffer,10);if(!(f>=0&&f<this.buffers.length))return;r[u].buffer=f,r[u].rate="rate"in r[u]&&r[u].rate>=0?parseFloat(r[u].rate):1,r[u].loop="loop"in r[u]&&Boolean(r[u].loop),r[u].start="start"in r[u]&&r[u].start>=0?parseFloat(r[u].start):0,r[u].end="end"in r[u]&&r[u].end>=0?parseFloat(r[u].end):0,r[u].volume="volume"in r[u]&&r[u].volume>=0&&r[u].volume<=1?parseFloat(r[u].volume):1,this.isStops[u]=!0,this.volumes[u]=this.context.createGain(),this.envelopegenerator.setGenerator(u)}this.settings=r;for(var h=!1,p=parseInt(i,10),y=function(t,r){var i=new XMLHttpRequest;i.timeout=p>0?p:6e4,i.ontimeout=function(t){h||"[object Function]"!==Object.prototype.toString.call(s)||s(t,e.ERROR_AJAX_TIMEOUT),h=!0},i.onprogress=function(t){h?i.abort():"[object Function]"===Object.prototype.toString.call(a)&&a(t)},i.onerror=function(t){h||"[object Function]"!==Object.prototype.toString.call(s)||s(t,e.ERROR_AJAX),h=!0},i.onload=function(t){if(200===i.status){var a=i.response;if(!(a instanceof ArrayBuffer))return;var l=function(e){o.buffers[r]=e;var i=!0,s=!1,a=void 0;try{for(var l,u=o.buffers[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){if(void 0===l.value)return}}catch(t){s=!0,a=t}finally{try{!i&&u.return&&u.return()}finally{if(s)throw a}}"[object Function]"===Object.prototype.toString.call(n)&&n(t,o.buffers)},u=function(t){"[object Function]"===Object.prototype.toString.call(s)&&s(t,e.ERROR_DECODE)};o.context.decodeAudioData(a,l,u)}},i.open("GET",t,!0),i.responseType="arraybuffer",i.send(null)},d=0,v=this.resources.length;d<v;d++)"string"==typeof this.resources[d]?y(this.resources[d],d):this.resources[d]instanceof AudioBuffer&&(this.buffers[d]=this.resources[d]);return this}},{key:"param",value:function(t,r){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var i in arguments[0])this.param(i,arguments[0][i]);else{var s=String(t).replace(/-/g,"").toLowerCase(),a=n(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"param",this).call(this,s,r);if(void 0!==a)return a;var o=null;switch(s){case"transpose":if(void 0===r)return this.transpose;(o=parseFloat(r))>0&&(this.transpose=o)}}return this}},{key:"ready",value:function(t,e){var r=parseFloat(t),i=parseFloat(e);return this.times.start=r>=0?r:0,this.times.stop=i>=r?i:0,this.envelopegenerator.clear(!1),this}},{key:"start",value:function(t,e,r){var i=this,n=parseInt(t,10);if(isNaN(n)||n<0||n>=this.settings.length)return this;var s=this.settings[n].buffer,a=this.settings[n].rate,o=this.settings[n].loop,l=this.settings[n].start,u=this.settings[n].end,c=this.settings[n].volume;if(!(this.buffers[s]instanceof AudioBuffer))return this;this.sources[n]instanceof AudioBufferSourceNode&&(this.sources[n].stop(this.context.currentTime),this.sources[n].disconnect(0),this.sources[n]=null);var f=this.context.createBufferSource();f.start=f.start||f.noteGrainOn,f.stop=f.stop||f.noteOff,f.buffer=this.buffers[s],f.playbackRate.value=a*this.transpose,f.loop=o,f.loopStart=l,f.loopEnd=u,this.volumes[n].gain.value=c,this.envelopegenerator.clear(!1),this.envelopegenerator.ready(n,f,this.volumes[n]),this.volumes[n].connect(this.processor),this.connect(this.processor,e);var h=this.context.currentTime+this.times.start;return f.start(h),this.sources[n]=f,this.envelopegenerator.start(h),this.on(h),this.isAnalyser||(this.analyser.start("time"),this.analyser.start("fft"),this.isAnalyser=!0),this.isStops[n]=!1,this.times.stop>0&&window.setTimeout(function(){i.stop(n)},1e3*this.times.stop),f.onended=function(){i.isStops[n]=!0},"[object Function]"===Object.prototype.toString.call(r)?this.processor.onaudioprocess=r:this.processor.onaudioprocess=function(t){if(i.isStop=i.isStops.every(function(t){return t}),i.isStop)i.off(i.context.currentTime),i.envelopegenerator.clear(!1),i.analyser.stop("time"),i.analyser.stop("fft"),i.isAnalyser=!1,i.processor.disconnect(0),i.processor.onaudioprocess=null;else{var e=t.inputBuffer.getChannelData(0),r=t.inputBuffer.getChannelData(1),n=t.outputBuffer.getChannelData(0),s=t.outputBuffer.getChannelData(1);n.set(e),s.set(r)}},this}},{key:"stop",value:function(t){var e=parseInt(t,10);if(isNaN(e)||e<0||e>=this.settings.length)return this;var r=this.settings[e].buffer;if(!(this.buffers[r]instanceof AudioBuffer&&this.sources[e]instanceof AudioBufferSourceNode))return this;var i=this.context.currentTime+this.times.stop;return this.envelopegenerator.stop(i),this.filter.stop(i),this}},{key:"get",value:function(t){var e=parseInt(t,10);return e>=0&&e<this.buffers.length?this.buffers[e]:this.buffers}},{key:"params",value:function(){var t=n(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"params",this).call(this);return t.oneshot={transpose:this.transpose},t}},{key:"reset",value:function(t,e,r){var i=parseInt(t,10);return String(e).toLowerCase()in this.settings[i]&&(this.settings[i][e.toLowerCase()]=r),this}},{key:"toString",value:function(){return"[OneshotModule]"}}]),e}();a.ERROR_AJAX="error",a.ERROR_AJAX_TIMEOUT="timeout",a.ERROR_DECODE="decode",e.default=a},function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),s=function t(e,r,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,r);if(void 0===n){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)},a=i(r(1)),o=i(r(34)),l=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.source=t.createBufferSource(),r.buffer=null,r.currentTime=0,r.paused=!0,r.callbacks={decode:function(){},ready:function(){},start:function(){},stop:function(){},update:function(){},ended:function(){},error:function(){}},r.vocalcanceler=new o.default,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),n(e,[{key:"setup",value:function(t,e){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var r in arguments[0])this.setup(r,arguments[0][r]);else{var i=String(t).replace(/-/g,"").toLowerCase();i in this.callbacks&&"[object Function]"===Object.prototype.toString.call(e)&&(this.callbacks[i]=e)}return this}},{key:"param",value:function(t,r){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var i in arguments[0])this.param(i,arguments[0][i]);else{var n=String(t).replace(/-/g,"").toLowerCase(),a=s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"param",this).call(this,n,r);if(void 0!==a)return a;var o=0,l=0;switch(n){case"playbackrate":if(void 0===r)return this.source.playbackRate.value;l=1024,(o=parseFloat(r))>=0&&o<=l&&(this.source.playbackRate.value=o);break;case"loop":case"looping":if(void 0===r)return this.source.loop;this.source.loop=Boolean(r);break;case"currenttime":if(void 0===r)return this.currentTime;this.buffer instanceof AudioBuffer?(o=parseFloat(r),l=this.buffer.duration,o>=0&&o<=l&&(this.paused?this.currentTime=o:(this.stop(),this.start(o)))):this.currentTime=0;break;case"duration":return this.buffer instanceof AudioBuffer?this.buffer.duration:0;case"samplerate":return this.buffer instanceof AudioBuffer?this.buffer.sampleRate:this.sampleRate;case"channels":return this.buffer instanceof AudioBuffer?this.buffer.numberOfChannels:0}}return this}},{key:"ready",value:function(t){var e=this;if(t instanceof ArrayBuffer){var r=function(t){e.buffer=t,e.analyser.start("timeOverviewL",t),e.analyser.start("timeOverviewR",t),e.callbacks.ready(t)};this.context.decodeAudioData(t,r,this.callbacks.error),this.callbacks.decode(t)}return this}},{key:"start",value:function(t,e,r){var i=this;if(this.buffer instanceof AudioBuffer&&this.paused){var n=this.context.currentTime,s=parseFloat(t);this.currentTime=s>=0&&s<=this.buffer.duration?s:0;var a=this.source.playbackRate.value,o=this.source.loop;this.source=this.context.createBufferSource(),this.source.start=this.source.start||this.source.noteGrainOn,this.source.stop=this.source.stop||this.source.noteOff,this.source.buffer=this.buffer,this.source.playbackRate.value=a,this.source.loop=o,this.source.connect(this.processor),this.connect(this.processor,e),this.source.start(n,s,this.buffer.duration-s),this.analyser.start("time"),this.analyser.start("fft"),this.paused=!1,this.on(n),this.callbacks.start(this.source,this.currentTime);var l=this.processor.bufferSize;"[object Function]"===Object.prototype.toString.call(r)?this.processor.onaudioprocess=r:this.processor.onaudioprocess=function(t){var e=t.inputBuffer.getChannelData(0),r=t.inputBuffer.getChannelData(1),n=t.outputBuffer.getChannelData(0),s=t.outputBuffer.getChannelData(1);if(i.currentTime<Math.floor(i.source.buffer.duration)){for(var a=0;a<l;a++){n[a]=i.vocalcanceler.start(e[a],r[a]),s[a]=i.vocalcanceler.start(r[a],e[a]),i.currentTime+=1*i.source.playbackRate.value/i.source.buffer.sampleRate;Math.floor(i.currentTime*i.source.buffer.sampleRate)%(.1*i.source.buffer.sampleRate)==0&&i.callbacks.update(i.source,i.currentTime)}i.analyser.timeOverviewL.update(i.currentTime),i.analyser.timeOverviewR.update(i.currentTime)}else i.source.loop?i.currentTime=0:i.end()}}return this}},{key:"stop",value:function(){if(this.buffer instanceof AudioBuffer&&!this.paused){var t=this.context.currentTime;this.source.stop(t),this.off(t),this.analyser.stop("time"),this.analyser.stop("fft"),this.processor.disconnect(0),this.processor.onaudioprocess=null,this.paused=!0,this.callbacks.stop(this.source,this.currentTime)}return this}},{key:"get",value:function(){return this.source}},{key:"toggle",value:function(t,e,r){return this.paused?this.start(t,e,r):this.stop(),this}},{key:"end",value:function(){return this.stop(),this.currentTime=0,this.callbacks.ended(this.source,this.currentTime),this}},{key:"isBuffer",value:function(){return this.buffer instanceof AudioBuffer}},{key:"isSource",value:function(){return this.source instanceof AudioBufferSourceNode&&this.source.buffer instanceof AudioBuffer}},{key:"isPaused",value:function(){return this.paused}},{key:"params",value:function(){var t=s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"params",this).call(this);return t.audio={playbackrate:this.isSource()?this.source.playbackRate.value:1,vocalcanceler:{depth:this.vocalcanceler.param("depth")}},t}},{key:"toString",value:function(){return"[AudioModule]"}}]),e}();e.default=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function t(e,r,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,r);if(void 0===n){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)},s=function(t){return t&&t.__esModule?t:{default:t}}(r(5)),a=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.source=null,r.media=null,r.ext="",r.playbackRate=1,r.controls=!1,r.loop=!1,r.muted=!1,r.autoplay=!1,r.listeners={},r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),i(e,[{key:"setup",value:function(t,r,i,n){var s=this;if("[object Object]"===Object.prototype.toString.call(arguments[0])){var a=arguments[0];"media"in a&&(t=a.media),"formats"in a&&(r=a.formats),"listeners"in a&&(i=a.listeners),"autoplay"in a&&(n=a.autoplay)}var o="";if(t instanceof HTMLAudioElement)o=e.AUDIO;else{if(!(t instanceof HTMLVideoElement))return this;o=e.VIDEO}this.media=t,Array.isArray(r)||(r=[r]);var l=!0,u=!1,c=void 0;try{for(var f,h=r[Symbol.iterator]();!(l=(f=h.next()).done);l=!0){var p=f.value,y=o+"/"+String(p).toLowerCase();if(/^(?:maybe|probably)/.test(this.media.canPlayType(y))){this.ext=p;break}}}catch(t){u=!0,c=t}finally{try{!l&&h.return&&h.return()}finally{if(u)throw c}}if(""===this.ext)throw new Error("Media format that can be played does not exist.");if("[object Object]"===Object.prototype.toString.call(i))for(var d in i)this.listeners[d.toLowerCase()]="[object Function]"===Object.prototype.toString.call(i[d])?i[d]:function(){};this.autoplay=Boolean(n),!this.autoplay||this.source instanceof MediaElementAudioSourceNode||(this.source=this.context.createMediaElementSource(this.media)),this.media.addEventListener("loadstart",function(t){s.source instanceof MediaElementAudioSourceNode||(s.source=s.context.createMediaElementSource(s.media)),"loadstart"in s.listeners&&s.listeners.loadstart(t)},!1),this.media.addEventListener("ended",function(t){s.media.pause(),s.off(s.context.currentTime),s.analyser.stop("time"),s.analyser.stop("fft"),s.processor.disconnect(0),s.processor.onaudioprocess=null,"ended"in s.listeners&&s.listeners.ended(t)},!1);for(var v in this.listeners)this.media.addEventListener(v,function(t){s.listeners[t.type.toLowerCase()](t)},!1);return this}},{key:"param",value:function(t,r){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var i in arguments[0])this.param(i,arguments[0][i]);else{var s=String(t).replace(/-/g,"").toLowerCase(),a=void 0;if("mastervolume"===s&&(a=n(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"param",this).call(this,s,r)),void 0!==a)return a;var o=null,l=null,u=null;switch(s){case"playbackrate":if(void 0===r)return this.media instanceof HTMLMediaElement?this.media.playbackRate:this.playbackRate;(o=parseFloat(r))>=(l=.5)&&(this.media instanceof HTMLMediaElement&&(this.media.playbackRate=o),this.playbackRate=o);break;case"currenttime":if(void 0===r)return this.media instanceof HTMLMediaElement?this.media.currentTime:0;this.media instanceof HTMLMediaElement&&(o=parseFloat(r),l=0,u=this.media.duration,o>=l&&o<=u&&(this.media.currentTime=o));break;case"loop":case"muted":case"controls":if(void 0===r)return this.media instanceof HTMLMediaElement?this.media[s]:this[s];this.media instanceof HTMLMediaElement&&(this.media[s]=Boolean(r)),this[s]=Boolean(r);break;case"width":case"height":if(void 0===r)return this.media instanceof HTMLVideoElement?this.media[s]:0;(o=parseInt(r,10))>=(l=0)&&this.media instanceof HTMLVideoElement&&(this.media[s]=o);break;case"duration":return this.media.duration;case"channels":return this.source instanceof MediaElementAudioSourceNode?this.source.channelCount:0}}return this}},{key:"ready",value:function(t){var e=String(t);try{-1!==e.indexOf("data:")||-1!==e.indexOf("blob:")?this.media.src=e:this.media.src=e+"."+this.ext}catch(t){throw new Error("The designated resource cannot be loaded.")}return this}},{key:"start",value:function(t,e,r){var i=this;if(this.source instanceof MediaElementAudioSourceNode&&this.media.paused){this.source.connect(this.processor),this.connect(this.processor,e),this.media.play();var n=parseFloat(t);this.media.currentTime=n>=0&&n<=this.media.duration?n:0,this.media.playbackRate=this.playbackRate,this.media.controls=this.controls,this.media.loop=this.loop,this.media.muted=this.muted,this.on(this.context.currentTime),this.analyser.start("time"),this.analyser.start("fft");var s=this.processor.bufferSize;"[object Function]"===Object.prototype.toString.call(r)?this.processor.onaudioprocess=r:this.processor.onaudioprocess=function(t){for(var e=t.inputBuffer.getChannelData(0),r=t.inputBuffer.getChannelData(1),n=t.outputBuffer.getChannelData(0),a=t.outputBuffer.getChannelData(1),o=0;o<s;o++)n[o]=i.vocalcanceler.start(e[o],r[o]),a[o]=i.vocalcanceler.start(r[o],e[o])}}return this}},{key:"stop",value:function(){return this.source instanceof MediaElementAudioSourceNode&&!this.media.paused&&(this.media.pause(),this.off(this.context.currentTime),this.analyser.stop("time"),this.analyser.stop("fft"),this.processor.disconnect(0),this.processor.onaudioprocess=null),this}},{key:"get",value:function(){return this.source}},{key:"toggle",value:function(t,e,r){return this.media.paused?this.start(t,e,r):this.stop(),this}},{key:"isMedia",value:function(){return this.media instanceof HTMLMediaElement}},{key:"isSource",value:function(){return this.source instanceof MediaElementAudioSourceNode}},{key:"isPaused",value:function(){return!(this.media instanceof HTMLMediaElement)||this.media.paused}},{key:"params",value:function(){var t=n(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"params",this).call(this);return t.media={playbackrate:this.playbackRate,vocalcanceler:{depth:this.vocalcanceler.param("depth")}},delete t.audio,t}},{key:"toString",value:function(){return"[MediaModule]"}}]),e}();a.AUDIO="audio",a.VIDEO="video",e.default=a},function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),s=function t(e,r,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,r);if(void 0===n){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)},a=i(r(1)),o=i(r(35)),l=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.source=null,r.constraints={audio:!0,video:!1},r.callbacks={stream:function(){},error:function(){}},r.output=!0,r.isStop=!0,r.noisegate=new o.default,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),n(e,[{key:"setup",value:function(t,e,r){return"[object Object]"===Object.prototype.toString.call(t)&&(this.constraints=t),"[object Function]"===Object.prototype.toString.call(e)&&(this.callbacks.stream=e),"[object Function]"===Object.prototype.toString.call(r)&&(this.callbacks.error=r),this}},{key:"param",value:function(t,r){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var i in arguments[0])this.param(i,arguments[0][i]);else{var n=String(t).replace(/-/g,"").toLowerCase(),a=s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"param",this).call(this,n,r);if(void 0!==a)return a;switch(n){case"output":if(void 0===r)return this.output;this.output=Boolean(r)}}return this}},{key:"ready",value:function(){return this}},{key:"start",value:function(t,e){var r=this;if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Cannot use WebRTC.");var i=this.processor.bufferSize,n=!1,s=function(t,e,s){r.source=r.context.createMediaStreamSource(t),r.source.connect(r.processor),r.connect(r.processor,e),r.output||(r.mastervolume.disconnect(0),r.mastervolume.connect(r.analyser.input),r.mastervolume.connect(r.recorder.processor),r.recorder.processor.connect(r.context.destination),r.mastervolume.connect(r.session.sender),r.session.sender.connect(r.context.destination)),r.on(r.context.currentTime),n||(r.analyser.start("time"),r.analyser.start("fft"),n=!0),"[object Function]"===Object.prototype.toString.call(s)?r.processor.onaudioprocess=s:r.processor.onaudioprocess=function(t){for(var e=t.inputBuffer.getChannelData(0),n=t.inputBuffer.getChannelData(1),s=t.outputBuffer.getChannelData(0),a=t.outputBuffer.getChannelData(1),o=0;o<i;o++)s[o]=r.noisegate.start(e[o]),a[o]=r.noisegate.start(n[o])}};return this.isStop=!1,navigator.mediaDevices.getUserMedia(this.constraints).then(function(i){r.isStop||(s(i,t,e),r.callbacks.stream(i))}).catch(function(t){r.callbacks.error(t)}),this}},{key:"stop",value:function(){return this.source=null,this.off(this.context.currentTime,!0),this.analyser.stop("time"),this.analyser.stop("fft"),this.processor.disconnect(0),this.processor.onaudioprocess=null,this.isStop=!0,this}},{key:"get",value:function(){return this.source}},{key:"toggle",value:function(t,e){return this.isStreaming()?this.stop():this.start(t,e),this}},{key:"isStreaming",value:function(){return!this.isStop}},{key:"params",value:function(){var t=s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"params",this).call(this);return t.stream={output:this.output,noisegate:{level:this.noisegate.param("level")}},t}},{key:"toString",value:function(){return"[StreamModule]"}}]),e}();e.default=l},function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}var n=i(r(1)),s=i(r(3)),a=i(r(4)),o=i(r(5)),l=i(r(6)),u=i(r(7)),c=i(r(36)),f=i(r(37)),h=i(r(38)),p=r(39);window.AudioContext=window.AudioContext||window.webkitAudioContext;var y=Boolean(window.AudioContext);if(y){var d=new AudioContext;d.createScriptProcessor=d.createScriptProcessor||d.createJavaScriptNode,d.createGain=d.createGain||d.createGainNode,d.createDelay=d.createDelay||d.createDelayNode,d.createPeriodicWave=d.createPeriodicWave||d.createWaveTable;var v={oscillator:new s.default(d),oneshot:new a.default(d),audio:new o.default(d),media:new l.default(d),stream:new u.default(d),mixer:new c.default(d),midi:new f.default(d),mml:new h.default(d)},b=function(t,e){var r=String(t).replace(/-/g,"").toLowerCase();switch(r){case"oscillator":if(void 0===e)return v.oscillator;var i=parseInt(e,10);return i>=0&&i<v.oscillator.length()?v.oscillator.get(i):null;case"oneshot":case"audio":case"media":case"stream":case"mixer":case"midi":case"mml":return v[r];default:return null}};b.IS_XSOUND=y,b.SAMPLE_RATE=d.sampleRate,b.NUMBER_OF_INPUTS=n.default.NUMBER_OF_INPUTS,b.NUMBER_OF_OUTPUTS=n.default.NUMBER_OF_OUTPUTS,b.read=p.read,b.file=p.file,b.ajax=p.ajax,b.decode=p.decode,b.toFrequencies=p.toFrequencies,b.convertTime=p.convertTime,b.fullscreen=p.fullscreen,b.exitFullscreen=p.exitFullscreen,b.clone=function(){var t={oscillator:new s.default(d),oneshot:new a.default(d),audio:new o.default(d),media:new l.default(d),stream:new u.default(d),mixer:new c.default(d),midi:new f.default(d),mml:new h.default(d)},e=function(e,r){var i=String(e).replace(/-/g,"").toLowerCase();switch(i){case"oscillator":if(void 0===r)return t.oscillator;var n=parseInt(r,10);return n>=0&&n<t.oscillator.length()?t.oscillator.get(n):null;case"oneshot":case"audio":case"media":case"stream":case"mixer":case"midi":case"mml":return t[i];default:return null}};return e.free=function(e){Array.isArray(e)||(e=[e]);var r=!0,i=!1,n=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var o=s.value;if(null!==o)for(var l in t)o===t[l]&&(t[l]=null)}}catch(t){i=!0,n=t}finally{try{!r&&a.return&&a.return()}finally{if(i)throw n}}},e},b.free=function(t){Array.isArray(t)||(t=[t]);var e=!0,r=!1,i=void 0;try{for(var n,s=t[Symbol.iterator]();!(e=(n=s.next()).done);e=!0){var a=n.value;if(null!==a)for(var o in v)a===v[o]&&(v[o]=null)}}catch(t){r=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(r)throw i}}},b.noConflict=function(t){return window.X===b&&(window.X=void 0),t&&window.XSound===b&&(window.XSound=void 0),b},b.get=function(){return d},b.getCurrentTime=function(){return d.currentTime},b.toString=function(){return"[XSound]"},window.XSound=b,window.X=b}else{var m=function(){return null};m.IS_XSOUND=y,window.XSound=m,window.X=m}},function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),s=i(r(10)),a=i(r(11)),o=i(r(12)),l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)},window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.clearTimeout,this.analyser=e.createAnalyser(),this.input=e.createGain(),this.input.connect(this.analyser),this.timeOverviewL=new s.default(e.sampleRate),this.timeOverviewR=new s.default(e.sampleRate),this.time=new a.default(e.sampleRate),this.fft=new o.default(e.sampleRate),this.analyser.fftSize=2048,this.analyser.minDecibels=-100,this.analyser.maxDecibels=-30,this.analyser.smoothingTimeConstant=.8}return n(t,[{key:"param",value:function(t,e){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var r in arguments[0])this.param(r,arguments[0][r]);else{var i=null,n=null;switch(String(t).replace(/-/g,"").toLowerCase()){case"fftsize":if(void 0===e)return this.analyser.fftSize;switch(i=parseInt(e,10)){case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:this.analyser.fftSize=i}break;case"frequencybincount":return this.analyser.frequencyBinCount;case"mindecibels":if(void 0===e)return this.analyser.minDecibels;(i=parseFloat(e))<(n=-30)&&(this.analyser.minDecibels=i);break;case"maxdecibels":if(void 0===e)return this.analyser.maxDecibels;(i=parseFloat(e))>-100&&(this.analyser.maxDecibels=i);break;case"smoothingtimeconstant":if(void 0===e)return this.analyser.smoothingTimeConstant;n=1,(i=parseFloat(e))>=0&&i<=n&&(this.analyser.smoothingTimeConstant=i)}}return this}},{key:"start",value:function(t,e){var r=this,i=null;switch(String(t).replace(/-/g,"").toLowerCase()){case"timeoverviewl":e instanceof AudioBuffer&&e.numberOfChannels>0&&((i=new Float32Array(e.length)).set(e.getChannelData(0)),this.timeOverviewL.start(i));break;case"timeoverviewr":e instanceof AudioBuffer&&e.numberOfChannels>1&&((i=new Float32Array(e.length)).set(e.getChannelData(1)),this.timeOverviewR.start(i));break;case"time":"uint"===this.time.param("type")?(i=new Uint8Array(this.analyser.fftSize),this.analyser.getByteTimeDomainData(i),this.time.start(i)):(i=new Float32Array(this.analyser.fftSize),this.analyser.getFloatTimeDomainData(i),this.time.start(i)),"auto"===this.time.param("interval")?this.time.timerid=window.requestAnimationFrame(function(){r.start(t)}):this.time.timerid=window.setTimeout(function(){r.start(t)},this.time.param("interval"));break;case"fft":"uint"===this.fft.param("type")?(i=new Uint8Array(this.analyser.frequencyBinCount),this.analyser.getByteFrequencyData(i),this.fft.start(i)):(i=new Float32Array(this.analyser.frequencyBinCount),this.analyser.getFloatFrequencyData(i),this.fft.start(i,this.analyser.minDecibels,this.analyser.maxDecibels)),"auto"===this.fft.param("interval")?this.fft.timerid=window.requestAnimationFrame(function(){r.start(t)}):this.fft.timerid=window.setTimeout(function(){r.start(t)},this.fft.param("interval"))}return this}},{key:"stop",value:function(t){switch(String(t).replace(/-/g,"").toLowerCase()){case"timeoverviewl":case"timeoverviewr":break;case"time":"auto"===this.time.param("interval")?window.cancelAnimationFrame(this.time.timerid):window.clearTimeout(this.time.timerid),this.time.timerid=null;break;case"fft":"auto"===this.fft.param("interval")?window.cancelAnimationFrame(this.fft.timerid):window.clearTimeout(this.fft.timerid),this.fft.timerid=null}return this}},{key:"domain",value:function(t){var e=String(t).replace(/-/g,"").toLowerCase();switch(e){case"timeoverviewl":case"timeoverviewr":return this["timeOverview"+e.slice(-1).toUpperCase()];case"time":case"fft":return this[e];default:return this}}},{key:"get",value:function(){return this.analyser}},{key:"toString",value:function(){return"[SoundModule Analyser]"}}]),t}();e.default=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(2)),s=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.savedImage=null,r.length=0,r.currentTime="rgba(255, 255, 255, 1.0)",r.plotInterval=.0625,r.textInterval=60,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,r){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var i in arguments[0])this.param(i,arguments[0][i]);else{var n=String(t).replace(/-/g,"").toLowerCase(),s=function t(e,r,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,r);if(void 0===n){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"param",this).call(this,n,r);if(void 0!==s)return s;var a=null;switch(n){case"currenttime":if(void 0===r)return this.currentTime;this.currentTime=String(r).toLowerCase();break;case"plotinterval":case"textinterval":if(void 0===r)return this[n.replace("interval","Interval")];(a=parseFloat(r))>0&&(this[n.replace("interval","Interval")]=a)}}return this}},{key:"drawOnCanvas",value:function(t){if(!(this.canvas instanceof HTMLCanvasElement&&this.isActive))return this;var e=this.context,r=this.canvas,i=r.width,n=r.height,s=i-(this.styles.left+this.styles.right),a=n-(this.styles.top+this.styles.bottom),o=Math.floor(a/2)+this.styles.top,l=Math.floor(this.plotInterval*this.sampleRate),u=Math.floor(this.textInterval*this.sampleRate);if(e.clearRect(0,0,i,n),this.drawTimeDomainFloat32ArrayOnCanvas(e,t,s,a,o,l),"none"!==this.styles.grid||"none"!==this.styles.text){for(var c=0,f=t.length;c<f;c++)if(c%u==0){var h=Math.floor(c/f*s)+this.styles.left,p=Math.floor(c/this.sampleRate/60)+" min";"none"!==this.styles.grid&&(e.fillStyle=this.styles.grid,e.fillRect(h,this.styles.top,1,a)),"none"!==this.styles.text&&(e.fillStyle=this.styles.text,e.font=this.createFontString(),e.fillText(p,h-e.measureText(p).width/2,this.styles.top+a+parseInt(this.styles.font.size,10)))}var y=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"],d=!0,v=!1,b=void 0;try{for(var m,g=y[Symbol.iterator]();!(d=(m=g.next()).done);d=!0){var w=m.value,O=Math.floor(this.styles.left-e.measureText(w).width),S=Math.floor((1-parseFloat(w.trim()))*(a/2))+this.styles.top;"none"!==this.styles.grid&&(e.fillStyle=this.styles.grid,e.fillRect(this.styles.left,S,s,1)),"none"!==this.styles.text&&(e.fillStyle=this.styles.text,e.font=this.createFontString(),e.fillText(w,O,S-Math.floor(parseInt(this.styles.font.size,10)/4)))}}catch(t){v=!0,b=t}finally{try{!d&&g.return&&g.return()}finally{if(v)throw b}}}return this.savedImage=e.getImageData(0,0,i,n),this.length=t.length,e.fillStyle=this.currentTime,e.fillRect(this.styles.left,this.styles.top,1,a),this}},{key:"drawBySVG",value:function(t){if(!(this.svg instanceof SVGElement&&this.isActive))return this;var e=this.svg,r=parseInt(e.getAttribute("width"),10),i=parseInt(e.getAttribute("height"),10),s=r-(this.styles.left+this.styles.right),a=i-(this.styles.top+this.styles.bottom),o=Math.floor(a/2)+this.styles.top,l=Math.floor(this.plotInterval*this.sampleRate),u=Math.floor(this.textInterval*this.sampleRate);if(e.innerHTML="",e.appendChild(this.drawTimeDomainFloat32ArrayBySVG(t,s,a,o,l,n.default.SVG_LINEAR_GRADIENT_ID_TIME_OVERVIEW)),"none"!==this.styles.grid||"none"!==this.styles.text){for(var c=0,f=t.length;c<f;c++)if(c%u==0){var h=Math.floor(c/f*s)+this.styles.left,p=Math.floor(c/this.sampleRate/60)+" min";if("none"!==this.styles.grid){var y=document.createElementNS(n.default.XMLNS,"rect");y.setAttribute("x",h),y.setAttribute("y",this.styles.top),y.setAttribute("width",1),y.setAttribute("height",a),y.setAttribute("stroke","none"),y.setAttribute("fill",this.styles.grid),e.appendChild(y)}if("none"!==this.styles.text){var d=document.createElementNS(n.default.XMLNS,"text");d.textContent=p,d.setAttribute("x",h),d.setAttribute("y",this.styles.top+a+parseInt(this.styles.font.size,10)),d.setAttribute("text-anchor","middle"),d.setAttribute("stroke","none"),d.setAttribute("fill",this.styles.text),d.setAttribute("font-family",this.styles.font.family),d.setAttribute("font-size",this.styles.font.size),d.setAttribute("font-style",this.styles.font.style),d.setAttribute("font-weight",this.styles.font.weight),e.appendChild(d)}}var v=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"],b=!0,m=!1,g=void 0;try{for(var w,O=v[Symbol.iterator]();!(b=(w=O.next()).done);b=!0){var S=w.value,A=this.styles.left,k=Math.floor((1-parseFloat(S.trim()))*(a/2))+this.styles.top;if("none"!==this.styles.grid){var _=document.createElementNS(n.default.XMLNS,"rect");_.setAttribute("x",A),_.setAttribute("y",k),_.setAttribute("width",s),_.setAttribute("height",1),_.setAttribute("stroke","none"),_.setAttribute("fill",this.styles.grid),e.appendChild(_)}if("none"!==this.styles.text){var T=document.createElementNS(n.default.XMLNS,"text");T.textContent=S,T.setAttribute("x",A),T.setAttribute("y",k-Math.floor(parseInt(this.styles.font.size,10)/4)),T.setAttribute("text-anchor","end"),T.setAttribute("stroke","none"),T.setAttribute("fill",this.styles.text),T.setAttribute("font-family",this.styles.font.family),T.setAttribute("font-size",this.styles.font.size),T.setAttribute("font-style",this.styles.font.style),T.setAttribute("font-weight",this.styles.font.weight),e.appendChild(T)}}}catch(t){m=!0,g=t}finally{try{!b&&O.return&&O.return()}finally{if(m)throw g}}}var j=document.createElementNS(n.default.XMLNS,"rect");return j.classList.add("svg-current-time"),j.setAttribute("x",this.styles.left),j.setAttribute("y",this.styles.top),j.setAttribute("width",1),j.setAttribute("height",a),j.setAttribute("stroke","none"),j.setAttribute("fill",this.currentTime),e.appendChild(j),this.savedImage=e,this.length=t.length,this}},{key:"update",value:function(t){var e=parseFloat(t);if(isNaN(e)||e<0)return this;switch(this.graphics){case n.default.CANVAS:if(this.savedImage instanceof ImageData){var r=this.context,i=this.canvas,s=i.width,a=i.height,o=s-(this.styles.left+this.styles.right),l=a-(this.styles.top+this.styles.bottom),u=Math.floor(e*this.sampleRate/this.length*o)+this.styles.left;r.clearRect(0,0,s,a),r.putImageData(this.savedImage,0,0),r.fillStyle=this.currentTime,r.fillRect(u,this.styles.top,1,l)}break;case n.default.SVG:var c=this.svg.querySelector(".svg-current-time");if(c instanceof SVGElement){var f=parseInt(this.svg.getAttribute("width"),10)-(this.styles.left+this.styles.right),h=Math.floor(e*this.sampleRate/this.length*f);c.setAttribute("transform","translate("+h+" 0)")}}return this}},{key:"drag",value:function(t){var e=this,r=null,i="",s="",a="";switch(/iPhone|iPad|iPod|Android/.test(navigator.userAgent)?(i="touchstart",s="touchmove",a="touchend"):(i="mousedown",s="mousemove",a="mouseup"),this.graphics){case n.default.CANVAS:r=this.canvas;break;case n.default.SVG:r=this.svg;break;default:return this}var o=!1;return r.addEventListener(i,function(r){e.draw(e.getOffsetX(r),t),o=!0},!0),r.addEventListener(s,function(r){o&&(r.preventDefault(),e.draw(e.getOffsetX(r),t))},!0),window.addEventListener(a,function(){o&&(o=!1)},!0),this}},{key:"draw",value:function(t,e){var r=0,i=0;switch(this.graphics){case n.default.CANVAS:r=this.canvas.offsetLeft,i=this.canvas.width;break;case n.default.SVG:r=this.svg.parentNode.offsetLeft,i=parseInt(this.svg.getAttribute("width"),10)}var s=t-(r+this.styles.left);i-=this.styles.left+this.styles.right,s<0&&(s=0),s>i&&(s=i);var a=s/i*this.length/this.sampleRate;return this.update(a),"[object Function]"===Object.prototype.toString.call(e)&&e(a),this}},{key:"getOffsetX",value:function(t){return t.pageX?t.pageX:t.touches[0]?t.touches[0].pageX:this}},{key:"toString",value:function(){return"[SoundModule Analyser TimeOverview]"}}]),e}();e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(2)),s=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.type=e.UINT,r.textInterval=.005,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,r){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var i in arguments[0])this.param(i,arguments[0][i]);else{var n=String(t).replace(/-/g,"").toLowerCase(),s=function t(e,r,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,r);if(void 0===n){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"param",this).call(this,n,r);if(void 0!==s)return s;var a=null;switch(n){case"type":if(void 0===r)return this.type;(a=String(r).toLowerCase())!==e.UINT&&a!==e.FLOAT||(this.type=a);break;case"textinterval":if(void 0===r)return this.textInterval;(a=parseFloat(r))>0&&(this.textInterval=a)}}return this}},{key:"drawOnCanvas",value:function(t){if(!(this.canvas instanceof HTMLCanvasElement&&this.isActive))return this;var r=this.context,i=this.canvas,n=i.width,s=i.height,a=n-(this.styles.left+this.styles.right),o=s-(this.styles.top+this.styles.bottom),l=Math.floor(o/2)+this.styles.top,u=Math.floor(this.textInterval*this.sampleRate);switch(r.clearRect(0,0,n,s),this.type){case e.FLOAT:this.drawTimeDomainFloat32ArrayOnCanvas(r,t,a,o,l);break;case e.UINT:default:switch(this.styles.shape){case"line":r.strokeStyle=this.styles.wave,r.lineWidth=this.styles.width,r.lineCap=this.styles.cap,r.lineJoin=this.styles.join,r.beginPath();for(var c=0,f=t.length;c<f;c++){var h=Math.floor(c/f*a)+this.styles.left,p=Math.floor((1-t[c]/255)*o)+this.styles.top;0===c?r.moveTo(h+this.styles.width/2,p):r.lineTo(h,p)}r.stroke();break;case"rect":"gradient"!==this.styles.wave&&(r.fillStyle=this.styles.wave);for(var y=0,d=t.length;y<d;y++){var v=Math.floor(y/d*a)+this.styles.left,b=Math.floor((.5-t[y]/255)*o);if("gradient"===this.styles.wave){var m=o/2+this.styles.top,g=r.createLinearGradient(0,m,0,m+b),w=!0,O=!1,S=void 0;try{for(var A,k=this.styles.grad[Symbol.iterator]();!(w=(A=k.next()).done);w=!0){var _=A.value;g.addColorStop(_.offset,_.color)}}catch(t){O=!0,S=t}finally{try{!w&&k.return&&k.return()}finally{if(O)throw S}}r.fillStyle=g}r.fillRect(v,l,this.styles.width,b)}}}if("none"!==this.styles.grid||"none"!==this.styles.text){for(var T=0,j=t.length;T<j;T++)if(T%u==0){var E=Math.floor(T/j*a)+this.styles.left,x=Math.floor(T/this.sampleRate*1e3)+" ms";"none"!==this.styles.grid&&(r.fillStyle=this.styles.grid,r.fillRect(E,this.styles.top,1,o)),"none"!==this.styles.text&&(r.fillStyle=this.styles.text,r.font=this.createFontString(),r.fillText(x,E-r.measureText(x).width/2,this.styles.top+o+parseInt(this.styles.font.size,10)))}var M=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"],R=!0,F=!1,C=void 0;try{for(var P,N=M[Symbol.iterator]();!(R=(P=N.next()).done);R=!0){var L=P.value,I=Math.floor(this.styles.left-r.measureText(L).width),D=Math.floor((1-parseFloat(L.trim()))*(o/2))+this.styles.top;"none"!==this.styles.grid&&(r.fillStyle=this.styles.grid,r.fillRect(this.styles.left,D,a,1)),"none"!==this.styles.text&&(r.fillStyle=this.styles.text,r.font=this.createFontString(),r.fillText(L,I,D-Math.floor(parseInt(this.styles.font.size,10)/4)))}}catch(t){F=!0,C=t}finally{try{!R&&N.return&&N.return()}finally{if(F)throw C}}}return this}},{key:"drawBySVG",value:function(t){if(!(this.svg instanceof SVGElement&&this.isActive))return this;var r=this.svg,i=parseInt(r.getAttribute("width"),10),s=parseInt(r.getAttribute("height"),10),a=i-(this.styles.left+this.styles.right),o=s-(this.styles.top+this.styles.bottom),l=Math.floor(o/2)+this.styles.top,u=Math.floor(this.textInterval*this.sampleRate);switch(r.innerHTML="",this.type){case e.FLOAT:r.appendChild(this.drawTimeDomainFloat32ArrayBySVG(t,a,o,l,null,n.default.SVG_LINEAR_GRADIENT_ID_TIME));break;case e.UINT:default:switch(this.styles.shape){case"line":for(var c=document.createElementNS(n.default.XMLNS,"path"),f="",h=0,p=t.length;h<p;h++){var y=Math.floor(h/p*a)+this.styles.left,d=Math.floor((1-t[h]/255)*o)+this.styles.top;f+=0===h?"M"+(y+this.styles.width/2)+" "+d:" L"+y+" "+d}c.setAttribute("d",f),c.setAttribute("stroke",this.styles.wave),c.setAttribute("fill","none"),c.setAttribute("stroke-width",this.styles.width),c.setAttribute("stroke-linecap",this.styles.cap),c.setAttribute("stroke-linejoin",this.styles.join),r.appendChild(c);break;case"rect":var v=null;"gradient"===this.styles.wave&&(v=this.createSVGLinearGradient(n.default.SVG_LINEAR_GRADIENT_ID_TIME));var b=document.createElementNS(n.default.XMLNS,"g");null!==v&&b.appendChild(v);for(var m=0,g=t.length;m<g;m++){var w=document.createElementNS(n.default.XMLNS,"rect"),O=Math.floor(m/g*a)+this.styles.left,S=Math.floor((t[m]/255-.5)*o);w.setAttribute("x",O),w.setAttribute("y",l),w.setAttribute("width",this.styles.width),S<0?w.setAttribute("height",-S):(w.setAttribute("height",S),w.setAttribute("transform","rotate(180 "+(O+this.styles.width/2)+" "+l+")")),w.setAttribute("stroke","none"),w.setAttribute("fill",null===v?this.styles.wave:"url(#"+n.default.SVG_LINEAR_GRADIENT_ID_TIME+")"),b.appendChild(w)}r.appendChild(b)}}if("none"!==this.styles.grid||"none"!==this.styles.text){for(var A=0,k=t.length;A<k;A++)if(A%u==0){var _=Math.floor(A/k*a)+this.styles.left,T=Math.floor(A/this.sampleRate*1e3)+" ms";if("none"!==this.styles.grid){var j=document.createElementNS(n.default.XMLNS,"rect");j.setAttribute("x",_),j.setAttribute("y",this.styles.top),j.setAttribute("width",1),j.setAttribute("height",o),j.setAttribute("stroke","none"),j.setAttribute("fill",this.styles.grid),r.appendChild(j)}if("none"!==this.styles.text){var E=document.createElementNS(n.default.XMLNS,"text");E.textContent=T,E.setAttribute("x",_),E.setAttribute("y",this.styles.top+o+parseInt(this.styles.font.size,10)),E.setAttribute("text-anchor","middle"),E.setAttribute("stroke","none"),E.setAttribute("fill",this.styles.text),E.setAttribute("font-family",this.styles.font.family),E.setAttribute("font-size",this.styles.font.size),E.setAttribute("font-style",this.styles.font.style),E.setAttribute("font-weight",this.styles.font.weight),r.appendChild(E)}}var x=["-1.00","-0.50"," 0.00"," 0.50"," 1.00"],M=!0,R=!1,F=void 0;try{for(var C,P=x[Symbol.iterator]();!(M=(C=P.next()).done);M=!0){var N=C.value,L=this.styles.left,I=Math.floor((1-parseFloat(N.trim()))*(o/2))+this.styles.top;if("none"!==this.styles.grid){var D=document.createElementNS(n.default.XMLNS,"rect");D.setAttribute("x",L),D.setAttribute("y",I),D.setAttribute("width",a),D.setAttribute("height",1),D.setAttribute("stroke","none"),D.setAttribute("fill",this.styles.grid),r.appendChild(D)}if("none"!==this.styles.text){var q=document.createElementNS(n.default.XMLNS,"text");q.textContent=N,q.setAttribute("x",L),q.setAttribute("y",I-Math.floor(parseInt(this.styles.font.size,10)/4)),q.setAttribute("text-anchor","end"),q.setAttribute("stroke","none"),q.setAttribute("fill",this.styles.text),q.setAttribute("font-family",this.styles.font.family),q.setAttribute("font-size",this.styles.font.size),q.setAttribute("font-style",this.styles.font.style),q.setAttribute("font-weight",this.styles.font.weight),r.appendChild(q)}}}catch(t){R=!0,F=t}finally{try{!M&&P.return&&P.return()}finally{if(R)throw F}}}return this}},{key:"toString",value:function(){return"[SoundModule Analyser Time]"}}]),e}();s.UINT="uint",s.FLOAT="float",e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(2)),s=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.type=e.UINT,r.size=256,r.textInterval=1e3,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,r){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var i in arguments[0])this.param(i,arguments[0][i]);else{var n=String(t).replace(/-/g,"").toLowerCase(),s=function t(e,r,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,r);if(void 0===n){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"param",this).call(this,n,r);if(void 0!==s)return s;var a=null,o=null;switch(n){case"type":if(void 0===r)return this.type;(a=String(r).toLowerCase())!==e.UINT&&a!==e.FLOAT||(this.type=a);break;case"size":if(void 0===r)return this.size;o=1024,(a=parseInt(r,10))>0&&a<=o&&(this.size=a);break;case"textinterval":if(void 0===r)return this.textInterval;(a=parseFloat(r))>0&&(this.textInterval=a)}}return this}},{key:"drawOnCanvas",value:function(t,r,i){if(!(this.canvas instanceof HTMLCanvasElement&&this.isActive))return this;var n=parseFloat(r),s=parseFloat(i),a=s-n,o=this.context,l=this.canvas,u=l.width,c=l.height,f=u-(this.styles.left+this.styles.right),h=c-(this.styles.top+this.styles.bottom),p=this.size>t.length?t.length:this.size,y=this.sampleRate/(2*t.length),d=Math.floor(this.textInterval/y);switch(o.clearRect(0,0,u,c),this.type){case e.FLOAT:o.strokeStyle="gradient"!==this.styles.wave?this.styles.wave:"rgba(0, 0, 255, 1.0)",o.lineWidth=this.styles.width,o.lineCap=this.styles.cap,o.lineJoin=this.styles.join,o.beginPath();for(var v=0;v<p;v++){var b=Math.floor(v/p*f)+this.styles.left,m=Math.abs(t[v]-s)*(h/a)+this.styles.top;0===v?o.moveTo(b+this.styles.width/2,m):o.lineTo(b,m)}o.stroke();break;case e.UINT:default:switch(this.styles.shape){case"line":o.strokeStyle=this.styles.wave,o.lineWidth=this.styles.width,o.lineCap=this.styles.cap,o.lineJoin=this.styles.join,o.beginPath();for(var g=0;g<p;g++){var w=Math.floor(g/p*f)+this.styles.left,O=Math.floor((1-t[g]/255)*h)+this.styles.top;0===g?o.moveTo(w+this.styles.width/2,O):o.lineTo(w,O)}o.stroke();break;case"rect":"gradient"!==this.styles.wave&&(o.fillStyle=this.styles.wave);for(var S=0;S<p;S++){var A=Math.floor(S/p*f)+this.styles.left,k=-1*Math.floor(t[S]/255*h);if("gradient"===this.styles.wave){var _=h+this.styles.top,T=o.createLinearGradient(0,_,0,_+k),j=!0,E=!1,x=void 0;try{for(var M,R=this.styles.grad[Symbol.iterator]();!(j=(M=R.next()).done);j=!0){var F=M.value;T.addColorStop(F.offset,F.color)}}catch(t){E=!0,x=t}finally{try{!j&&R.return&&R.return()}finally{if(E)throw x}}o.fillStyle=T}o.fillRect(A,h+this.styles.top,this.styles.width,k)}}}if("none"!==this.styles.grid||"none"!==this.styles.text){for(var C=0;C<p;C++)if(C%d==0){var P=Math.floor(C/p*f)+this.styles.left,N=Math.floor(this.textInterval*(C/d)),L=N<1e3?N+" Hz":String(N/1e3).slice(0,3)+" kHz";"none"!==this.styles.grid&&(o.fillStyle=this.styles.grid,o.fillRect(P,this.styles.top,1,h)),"none"!==this.styles.text&&(o.fillStyle=this.styles.text,o.font=this.createFontString(),o.fillText(L,P-o.measureText(L).width/2,this.styles.top+h+parseInt(this.styles.font.size,10)))}switch(this.type){case e.FLOAT:for(var I=n;I<=s;I+=10){var D=I+" dB",q=Math.floor(this.styles.left-o.measureText(D).width),B=Math.floor(-1*(I-s)/a*h)+this.styles.top;"none"!==this.styles.grid&&(o.fillStyle=this.styles.grid,o.fillRect(this.styles.left,B,f,1)),"none"!==this.styles.text&&(o.fillStyle=this.styles.text,o.font=this.createFontString(),o.fillText(D,q,B-Math.floor(parseInt(this.styles.font.size,10)/4)))}break;case e.UINT:default:var G=["0.00","0.25","0.50","0.75","1.00"],z=!0,U=!1,V=void 0;try{for(var X,W=G[Symbol.iterator]();!(z=(X=W.next()).done);z=!0){var H=X.value,Q=Math.floor(this.styles.left-o.measureText(H).width),J=(1-parseFloat(H))*h+this.styles.top;"none"!==this.styles.grid&&(o.fillStyle=this.styles.grid,o.fillRect(this.styles.left,J,f,1)),"none"!==this.styles.text&&(o.fillStyle=this.styles.text,o.font=this.createFontString(),o.fillText(H,Q,J-Math.floor(parseInt(this.styles.font.size,10)/4)))}}catch(t){U=!0,V=t}finally{try{!z&&W.return&&W.return()}finally{if(U)throw V}}}}return this}},{key:"drawBySVG",value:function(t,r,i){if(!(this.svg instanceof SVGElement&&this.isActive))return this;var s=parseFloat(r),a=parseFloat(i),o=a-s,l=this.svg,u=parseInt(l.getAttribute("width"),10),c=parseInt(l.getAttribute("height"),10),f=u-(this.styles.left+this.styles.right),h=c-(this.styles.top+this.styles.bottom),p=this.size>t.length?t.length:this.size,y=this.sampleRate/(2*t.length),d=Math.floor(this.textInterval/y);switch(l.innerHTML="",this.type){case e.FLOAT:for(var v=document.createElementNS(n.default.XMLNS,"path"),b="",m=0;m<p;m++){var g=Math.floor(m/p*f)+this.styles.left,w=Math.floor(-1*(t[m]-a)*(h/o))+this.styles.top;b+=0===m?"M"+(g+this.styles.width/2)+" "+w:" L"+g+" "+w}v.setAttribute("d",b),v.setAttribute("stroke","gradient"!==this.styles.wave?this.styles.wave:"rgba(0, 0, 255, 1.0)"),v.setAttribute("fill","none"),v.setAttribute("stroke-width",this.styles.width),v.setAttribute("stroke-linecap",this.styles.cap),v.setAttribute("stroke-linejoin",this.styles.join),l.appendChild(v);break;case e.UINT:default:switch(this.styles.shape){case"line":for(var O=document.createElementNS(n.default.XMLNS,"path"),S="",A=0;A<p;A++){var k=Math.floor(A/p*f)+this.styles.left,_=Math.floor((1-t[A]/255)*h)+this.styles.top;S+=0===A?"M"+(k+this.styles.width/2)+" "+_:" L"+k+" "+_}O.setAttribute("d",S),O.setAttribute("stroke",this.styles.wave),O.setAttribute("fill","none"),O.setAttribute("stroke-width",this.styles.width),O.setAttribute("stroke-linecap",this.styles.cap),O.setAttribute("stroke-linejoin",this.styles.join),l.appendChild(O);break;case"rect":var T=null;"gradient"===this.styles.wave&&(T=this.createSVGLinearGradient(n.default.SVG_LINEAR_GRADIENT_ID_FFT));var j=document.createElementNS(n.default.XMLNS,"g");null!==T&&j.appendChild(T);for(var E=0;E<p;E++){var x=document.createElementNS(n.default.XMLNS,"rect"),M=Math.floor(E/p*f)+this.styles.left,R=Math.floor(t[E]/255*h);x.setAttribute("x",M),x.setAttribute("y",this.styles.top+h),x.setAttribute("width",this.styles.width),R<0?x.setAttribute("height",-R):(x.setAttribute("height",R),x.setAttribute("transform","rotate(180 "+(M+this.styles.width/2)+" "+(this.styles.top+h)+")")),x.setAttribute("stroke","none"),x.setAttribute("fill",null===T?this.styles.wave:"url(#"+n.default.SVG_LINEAR_GRADIENT_ID_FFT+")"),j.appendChild(x)}l.appendChild(j)}}if("none"!==this.styles.grid||"none"!==this.styles.text){for(var F=0;F<p;F++)if(F%d==0){var C=Math.floor(F/p*f)+this.styles.left,P=Math.floor(this.textInterval*(F/d)),N=P<1e3?P+" Hz":String(P/1e3).slice(0,3)+" kHz";if("none"!==this.styles.grid){var L=document.createElementNS(n.default.XMLNS,"rect");L.setAttribute("x",C),L.setAttribute("y",this.styles.top),L.setAttribute("width",1),L.setAttribute("height",h),L.setAttribute("stroke","none"),L.setAttribute("fill",this.styles.grid),l.appendChild(L)}if("none"!==this.styles.text){var I=document.createElementNS(n.default.XMLNS,"text");I.textContent=N,I.setAttribute("x",C),I.setAttribute("y",this.styles.top+h+parseInt(this.styles.font.size,10)),I.setAttribute("text-anchor","middle"),I.setAttribute("stroke","none"),I.setAttribute("fill",this.styles.text),I.setAttribute("font-family",this.styles.font.family),I.setAttribute("font-size",this.styles.font.size),I.setAttribute("font-style",this.styles.font.style),I.setAttribute("font-weight",this.styles.font.weight),l.appendChild(I)}}switch(this.type){case e.FLOAT:for(var D=s;D<=a;D+=10){var q=D+"dB",B=this.styles.left,G=Math.floor(-1*(D-a)/o*h)+this.styles.top;if("none"!==this.styles.grid){var z=document.createElementNS(n.default.XMLNS,"rect");z.setAttribute("x",B),z.setAttribute("y",G),z.setAttribute("width",f),z.setAttribute("height",1),z.setAttribute("stroke","none"),z.setAttribute("fill",this.styles.grid),l.appendChild(z)}if("none"!==this.styles.text){var U=document.createElementNS(n.default.XMLNS,"text");U.textContent=q,U.setAttribute("x",B),U.setAttribute("y",G-Math.floor(parseInt(this.styles.font.size,10)/4)),U.setAttribute("text-anchor","end"),U.setAttribute("stroke","none"),U.setAttribute("fill",this.styles.text),U.setAttribute("font-family",this.styles.font.family),U.setAttribute("font-size",this.styles.font.size),U.setAttribute("font-style",this.styles.font.style),U.setAttribute("font-weight",this.styles.font.weight),l.appendChild(U)}}break;case e.UINT:default:var V=["0.00","0.25","0.50","0.75","1.00"],X=!0,W=!1,H=void 0;try{for(var Q,J=V[Symbol.iterator]();!(X=(Q=J.next()).done);X=!0){var Y=Q.value,Z=this.styles.left,K=(1-parseFloat(Y))*h+this.styles.top;if("none"!==this.styles.grid){var $=document.createElementNS(n.default.XMLNS,"rect");$.setAttribute("x",Z),$.setAttribute("y",K),$.setAttribute("width",f),$.setAttribute("height",1),$.setAttribute("stroke","none"),$.setAttribute("fill",this.styles.grid),l.appendChild($)}if("none"!==this.styles.text){var tt=document.createElementNS(n.default.XMLNS,"text");tt.textContent=Y,tt.setAttribute("x",Z),tt.setAttribute("y",K-Math.floor(parseInt(this.styles.font.size,10)/4)),tt.setAttribute("text-anchor","end"),tt.setAttribute("stroke","none"),tt.setAttribute("fill",this.styles.text),tt.setAttribute("font-family",this.styles.font.family),tt.setAttribute("font-size",this.styles.font.size),tt.setAttribute("font-style",this.styles.font.style),tt.setAttribute("font-weight",this.styles.font.weight),l.appendChild(tt)}}}catch(t){W=!0,H=t}finally{try{!X&&J.return&&J.return()}finally{if(W)throw H}}}}return this}},{key:"toString",value:function(){return"[SoundModule Analyser FFT]"}}]),e}();s.UINT="uint",s.FLOAT="float",e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(){function t(e,r,i,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sampleRate=e.sampleRate,this.context=e,this.processor=e.createScriptProcessor(r,i,n),this.mixedLs=null,this.mixedRs=null,this.numberOfTracks=0,this.trackLs=[],this.trackRs=[],this.activeTrack=-1,this.paused=!0,this.gainL=1,this.gainR=1}return i(t,[{key:"setup",value:function(t){var e=parseInt(t,10);if(e>0){this.numberOfTracks=e,this.trackLs=new Array(this.numberOfTracks),this.trackRs=new Array(this.numberOfTracks);for(var r=0;r<e;r++)this.trackLs[r]=[];for(var i=0;i<e;i++)this.trackRs[i]=[]}else this.numberOfTracks=1,this.trackLs=new Array(this.numberOfTracks),this.trackRs=new Array(this.numberOfTracks),this.trackLs[0]=[],this.trackRs[0]=[];return this}},{key:"param",value:function(t,e){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var r in arguments[0])this.param(r,arguments[0][r]);else{var i=String(t).replace(/-/g,"").toLowerCase(),n=null,s=null;switch(i){case"gainl":case"gainr":if(void 0===e)return this["gain"+i.slice(-1).toUpperCase()];s=1,(n=parseFloat(e))>=0&&n<=s&&(this["gain"+i.slice(-1).toUpperCase()]=n)}}return this}},{key:"ready",value:function(t){return this.isTrack(t)?this.activeTrack=t:this.activeTrack=-1,this}},{key:"start",value:function(){var t=this;if(-1!==this.activeTrack&&this.paused){this.paused=!1;var e=this.processor.bufferSize;this.processor.onaudioprocess=function(r){if(-1!==t.activeTrack){for(var i=r.inputBuffer.getChannelData(0),n=r.inputBuffer.getChannelData(1),s=new Float32Array(e),a=new Float32Array(e),o=0;o<e;o++)s[o]=t.gainL*i[o],a[o]=t.gainR*n[o];t.trackLs[t.activeTrack].push(s),t.trackRs[t.activeTrack].push(a)}else t.processor.disconnect(0),t.processor.onaudioprocess=null}}return this}},{key:"stop",value:function(){return this.activeTrack=-1,this.paused=!0,this.processor.disconnect(0),this.processor.onaudioprocess=null,this}},{key:"isTrack",value:function(t){var e=parseInt(t,10);return e>=0&&e<this.numberOfTracks}},{key:"getActiveTrack",value:function(){return this.activeTrack}},{key:"mixTrack",value:function(t){var e=this["track"+t+"s"],r={values:null,sum:0,num:0},i=this.processor.bufferSize,n=0,s=0,a=0,o=!0,l=!1,u=void 0;try{for(var c,f=e[Symbol.iterator]();!(o=(c=f.next()).done);o=!0){var h=c.value;a<h.length&&(a=h.length)}}catch(t){l=!0,u=t}finally{try{!o&&f.return&&f.return()}finally{if(l)throw u}}for(r.values=new Float32Array(a*i);;){for(var p=0,y=e.length;p<y;p++)e[p][n]instanceof Float32Array&&(r.sum+=e[p][n][s],r.num++);if(!(r.num>0))return r.values;var d=n*i;r.values[d+s]=r.sum/r.num,r.sum=0,r.num=0,s<i-1?s++:(n++,s=0)}}},{key:"mix",value:function(){return-1!==this.activeTrack&&this.stop(),this.mixedLs=this.mixTrack("L"),this.mixedRs=this.mixTrack("R"),this}},{key:"clear",value:function(t){if(-1!==this.activeTrack&&this.stop(),"all"===String(t).toLowerCase()){var e=!0,r=!1,i=void 0;try{for(var n,s=this.trackLs[Symbol.iterator]();!(e=(n=s.next()).done);e=!0){n.value.length=0}}catch(t){r=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(r)throw i}}var a=!0,o=!1,l=void 0;try{for(var u,c=this.trackRs[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){u.value.length=0}}catch(t){o=!0,l=t}finally{try{!a&&c.return&&c.return()}finally{if(o)throw l}}}else this.isTrack(t)&&(this.trackLs[t].length=0,this.trackRs[t].length=0);return this}},{key:"create",value:function(t,e,r){-1!==this.activeTrack&&this.stop();var i=null,n=null;if("all"===String(t).toLowerCase()?(this.mix(),i=this.mixedLs,n=this.mixedRs):this.isTrack(t)&&(i=this.trackLs[t-1],n=this.trackRs[t-1]),0===i.length&&0===n.length)return"";var s=1===e?1:2,a=8===r?8:16,o=1===s?Math.min(i.length,n.length):2*Math.min(i.length,n.length),l=36+o*(a/8),u=8+(28+(8+o*(a/8))),c=this.sampleRate,f=c*s*(a/8),h=o*(a/8),p=null;switch(a){case 8:p=new Uint8Array(o);for(var y=0;y<o;y++){var d=0;(d=y%s==0?(i[Math.floor(y/s)]+1)/2*(Math.pow(2,8)-1):(n[Math.floor(y/s)]+1)/2*(Math.pow(2,8)-1))>Math.pow(2,8)-1&&(d=Math.pow(2,8)-1),d<Math.pow(2,0)-1&&(d=Math.pow(2,0)-1),p[y]=d}break;case 16:p=new Int16Array(o);for(var v=0;v<o;v++){var b=0;(b=v%s==0?i[Math.floor(v/s)]*Math.pow(2,15):n[Math.floor(v/s)]*Math.pow(2,15))>+Math.pow(2,15)-1&&(b=Math.pow(2,15)-1),b<-Math.pow(2,15)-1&&(b=-Math.pow(2,15)-1),p[v]=b}}if(window.URL=window.URL||window.webkitURL||window.mozURL,window.URL&&window.URL.createObjectURL){var m=[];m[0]=82,m[1]=73,m[2]=70,m[3]=70,m[4]=l>>0&255,m[5]=l>>8&255,m[6]=l>>16&255,m[7]=l>>24&255,m[8]=87,m[9]=65,m[10]=86,m[11]=69,m[12]=102,m[13]=109,m[14]=116,m[15]=32,m[16]=16,m[17]=0,m[18]=0,m[19]=0,m[20]=1,m[21]=0,m[22]=s,m[23]=0,m[24]=c>>0&255,m[25]=c>>8&255,m[26]=c>>16&255,m[27]=c>>24&255,m[28]=f>>0&255,m[29]=f>>8&255,m[30]=f>>16&255,m[31]=f>>24&255,m[32]=s*(a/8),m[33]=0,m[34]=a,m[35]=0,m[36]=100,m[37]=97,m[38]=116,m[39]=97,m[40]=h>>0&255,m[41]=h>>8&255,m[42]=h>>16&255,m[43]=h>>24&255;for(var g=0;g<o;g++)switch(a){case 8:m[u-h+g]=p[g];break;case 16:m[u-h+2*g+0]=p[g]>>0&255,m[u-h+2*g+1]=p[g]>>8&255}var w=new Blob([new Uint8Array(m)],{type:"audio/wav"});return window.URL.createObjectURL(w)}var O="";O+="RIFF",O+=String.fromCharCode(l>>0&255,l>>8&255,l>>16&255,l>>24&255),O+="WAVE",O+="fmt "+String.fromCharCode(16,0,0,0),O+=String.fromCharCode(1,0),O+=String.fromCharCode(s,0),O+=String.fromCharCode(c>>0&255,c>>8&255,c>>16&255,c>>24&255),O+=String.fromCharCode(f>>0&255,f>>8&255,f>>16&255,f>>24&255),O+=String.fromCharCode(s*(a/8),0),O+=String.fromCharCode(a,0),O+="data",O+=String.fromCharCode(h>>0&255,h>>8&255,h>>16&255,h>>24&255);for(var S=0;S<o;S++)switch(a){case 8:O+=String.fromCharCode(p[S]);break;case 16:O+=String.fromCharCode(p[S]>>0&255,p[S]>>8&255)}return"data:audio/wav;base64,"+window.btoa(O)}},{key:"toString",value:function(){return"[SoundModule Recorder]"}}]),t}();e.default=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(){function t(e,r,i,n,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.isActive=!1,this.context=e,this.analyser=s,this.sender=e.createScriptProcessor(r,i,n),this.receiver=e.createScriptProcessor(r,i,n),this.websocket=null,this.paused=!0}return i(t,[{key:"setup",value:function(t,e,r,i,n,s,a){var o=this;if("[object Object]"===Object.prototype.toString.call(arguments[0])){var l=arguments[0];"tls"in l&&(t=l.tls),"host"in l&&(e=l.host),"port"in l&&(r=l.port),"path"in l&&(i=l.path),"open"in l&&(n=l.open),"close"in l&&(s=l.close),"error"in l&&(a=l.error)}var u=t?"wss://":"ws://";"/"!==i.charAt(0)&&(i="/"+i);var c=parseInt(r,10);return isNaN(c)||c<0||c>65535?this:(this.websocket=new WebSocket(""+u+e+":"+c+i),this.websocket.binaryType="arraybuffer",this.websocket.onopen=function(t){"[object Function]"===Object.prototype.toString.call(n)&&n(t)},this.websocket.onclose=function(t){o.isActive=!1,o.paused=!0,o.connect(),"[object Function]"===Object.prototype.toString.call(s)&&s(t)},this.websocket.onerror=function(t){o.isActive=!1,o.paused=!0,o.connect(),"[object Function]"===Object.prototype.toString.call(a)&&a(t)},this.websocket.onmessage=function(t){if(!o.isActive)return o.analyser.stop("time"),void o.analyser.stop("fft");if(t.data instanceof ArrayBuffer){var e=t.data.byteLength/Float32Array.BYTES_PER_ELEMENT,r=Math.floor(e/2),i=r*Float32Array.BYTES_PER_ELEMENT,n=new Float32Array(t.data,0,r),s=new Float32Array(t.data,i,r);o.analyser.start("time"),o.analyser.start("fft"),o.receiver.onaudioprocess=function(t){var e=t.outputBuffer.getChannelData(0),r=t.outputBuffer.getChannelData(1);n instanceof Float32Array&&e.set(n),s instanceof Float32Array&&r.set(s),o.isActive&&null!==o.websocket||(o.analyser.stop("time"),o.analyser.stop("fft"))}}},this)}},{key:"connect",value:function(){return this.receiver.disconnect(0),this.sender.disconnect(0),this.receiver.onaudioprocess=null,this.sender.onaudioprocess=null,this.isActive?(this.receiver.connect(this.analyser.input),this.receiver.connect(this.context.destination)):this.paused=!0,this}},{key:"start",value:function(){var t=this;if(this.isActive&&this.isConnected()&&this.paused){this.paused=!1;var e=this.sender.bufferSize;this.sender.onaudioprocess=function(r){if(t.isActive&&t.isConnected()){for(var i=r.inputBuffer.getChannelData(0),n=r.inputBuffer.getChannelData(1),s=new Float32Array(2*e),a=parseInt(s.length/2,10),o=0;o<e;o++)s[o]=i[o],s[a+o]=n[o];0===t.websocket.bufferedAmount&&t.websocket.send(s)}}}return this}},{key:"close",value:function(){return this.websocket instanceof WebSocket&&(this.isActive=!1,this.paused=!0,this.connect(),this.websocket.close(),this.websocket=null),this}},{key:"isConnected",value:function(){return this.websocket instanceof WebSocket&&this.websocket.readyState===WebSocket.OPEN}},{key:"state",value:function(t,e,r){var i=this;if(void 0===t)return this.isActive;"[object Function]"===Object.prototype.toString.call(r)&&r();var n=window.setInterval(function(){i.websocket instanceof WebSocket&&0!==i.websocket.bufferedAmount||("toggle"===String(t).toLowerCase()?i.isActive=!i.isActive:i.isActive=Boolean(t),i.connect(),"[object Function]"===Object.prototype.toString.call(e)&&e(),window.clearInterval(n))},10);return this}},{key:"get",value:function(){return this.websocket}},{key:"toString",value:function(){return"[SoundModule Session]"}}]),t}();e.default=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),s=function(t){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return i.compressor=t.createDynamicsCompressor(),i.compressor.threshold.value=-24,i.compressor.knee.value=30,i.compressor.ratio.value=12,i.compressor.attack.value=.003,i.compressor.release.value=.25,i.state(!0),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,e){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var r in arguments[0])this.param(r,arguments[0][r]);else{var i=String(t).replace(/-/g,"").toLowerCase();if(i in this.compressor){if(void 0===e)return this.compressor[i].value;var n=parseFloat(e);n>={threshold:-100,knee:0,ratio:1,attack:0,release:0}[i]&&n<={threshold:0,knee:40,ratio:20,attack:1,release:1}[i]&&(this.compressor[i].value=n)}}return this}},{key:"connect",value:function(){return this.input.disconnect(0),this.compressor.disconnect(0),this.isActive?(this.input.connect(this.compressor),this.compressor.connect(this.output)):this.input.connect(this.output),this}},{key:"params",value:function(){var t={state:this.isActive,threshold:this.compressor.threshold.value,knee:this.compressor.knee.value,ratio:this.compressor.ratio.value,attack:this.compressor.attack.value,release:this.compressor.release.value};return t}},{key:"toString",value:function(){return"[SoundModule Compressor]"}}]),e}();e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),s=function(t){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return i.distortion=t.createWaveShaper(),i.drive=t.createGain(),i.color=t.createBiquadFilter(),i.tone=t.createBiquadFilter(),i.type=e.CLEAN,i.numberOfSamples=4096,i.drive.gain.value=1,i.color.type="string"==typeof i.color.type?"bandpass":i.color.BANDPASS||2,i.color.frequency.value=350,i.color.Q.value=Math.SQRT1_2,i.color.gain.value=0,i.tone.type="string"==typeof i.tone.type?"lowpass":i.tone.LOWPASS||0,i.tone.frequency.value=350,i.tone.Q.value=Math.SQRT1_2,i.tone.gain.value=0,i.state(!1),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,r){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var i in arguments[0])this.param(i,arguments[0][i]);else{var n=String(t).replace(/-/g,"").toLowerCase(),s=null,a=null,o=null;switch(n){case"curve":if(void 0===r)return this.distortion.curve;var l=null;switch(String(r).toLowerCase()){case e.CLEAN:this.type=e.CLEAN,l=e.createCurve(e.AMOUNTS.CLEAN,this.numberOfSamples);break;case e.CRUNCH:this.type=e.CRUNCH,l=e.createCurve(e.AMOUNTS.CRUNCH,this.numberOfSamples);break;case e.OVERDRIVE:this.type=e.OVERDRIVE,l=e.createCurve(e.AMOUNTS.OVERDRIVE,this.numberOfSamples);break;case e.DISTORTION:this.type=e.DISTORTION,l=e.createCurve(e.AMOUNTS.DISTORTION,this.numberOfSamples);break;case e.FUZZ:this.type=e.FUZZ,l=e.createCurve(e.AMOUNTS.FUZZ,this.numberOfSamples);break;default:r instanceof Float32Array&&(l=r)}this.distortion.curve=l;break;case"samples":if(void 0===r)return this.numberOfSamples;(s=parseInt(r,10))>=0&&(this.numberOfSamples=s,this.param("curve",this.type));break;case"drive":if(void 0===r)return this.drive.gain.value;o=1,(s=parseFloat(r))>=(a=0)&&s<=o&&(this.drive.gain.value=s);break;case"color":case"tone":if(void 0===r)return this[n].frequency.value;s=parseFloat(r),a=10,o=this.context.sampleRate/2,s>=a&&s<=o&&(this[n].frequency.value=s)}}return this}},{key:"connect",value:function(){return this.input.disconnect(0),this.distortion.disconnect(0),this.drive.disconnect(0),this.color.disconnect(0),this.tone.disconnect(0),this.isActive?(this.input.connect(this.color),this.color.connect(this.distortion),this.distortion.connect(this.drive),this.drive.connect(this.tone),this.tone.connect(this.output)):this.input.connect(this.output),this}},{key:"params",value:function(){var t={state:this.isActive,curve:this.type,samples:this.numberOfSamples,drive:this.drive.gain.value,color:this.color.frequency.value,tone:this.tone.frequency.value};return t}},{key:"toString",value:function(){return"[SoundModule Distortion]"}}]),e}();s.CLEAN="clean",s.CRUNCH="crunch",s.OVERDRIVE="overdrive",s.DISTORTION="distortion",s.FUZZ="fuzz",s.AMOUNTS={CLEAN:0,CRUNCH:.5,OVERDRIVE:.7,DISTORTION:.8,FUZZ:.9},s.createCurve=function(t,e){if(t>0&&t<1){for(var r=new Float32Array(e),i=2*t/(1-t),n=0;n<e;n++){var s=2*(n-0)/(e-0)-1;r[n]=(1+i)*s/(1+i*Math.abs(s))}return r}return null},e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),s=function(t){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return i.lowpass=t.createBiquadFilter(),i.lowpass.type="string"==typeof i.lowpass.type?"lowpass":i.lowpass.LOWPASS||0,i.lowpass.frequency.value=350,i.lowpass.Q.value=1,i.lowpass.gain.value=0,i.depth.gain.value=0,i.rate.value=0,i.depthRate=0,i.state(!1),i.lfo.connect(i.depth),i.depth.connect(i.lowpass.frequency),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,e){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var r in arguments[0])this.param(r,arguments[0][r]);else{var i=null,n=null,s=null;switch(String(t).replace(/-/g,"").toLowerCase()){case"frequency":case"cutoff":if(void 0===e)return this.lowpass.frequency.value;i=parseFloat(e),n=10,s=this.context.sampleRate/2,i>=n&&i<=s&&(this.lowpass.frequency.value=i,this.depth.gain.value=this.lowpass.frequency.value*this.depthRate);break;case"depth":if(void 0===e)return this.depthRate;s=1,(i=parseFloat(e))>=(n=0)&&i<=s&&(this.depth.gain.value=this.lowpass.frequency.value*i,this.depthRate=i);break;case"rate":if(void 0===e)return this.rate.value;i=parseFloat(e),n=0,s=this.context.sampleRate/2,i>=n&&i<=s&&(this.rate.value=i);break;case"resonance":if(void 0===e)return this.lowpass.Q.value;s=1e3,(i=parseFloat(e))>=(n=1e-4)&&i<=s&&(this.lowpass.Q.value=i)}}return this}},{key:"stop",value:function(t,r){return function t(e,r,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,r);if(void 0===n){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"stop",this).call(this,t,r),this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.lowpass.frequency)),this}},{key:"connect",value:function(){return this.input.disconnect(0),this.lowpass.disconnect(0),this.isActive?(this.input.connect(this.lowpass),this.lowpass.connect(this.output)):this.input.connect(this.output),this}},{key:"params",value:function(){var t={state:this.isActive,cutoff:this.lowpass.frequency.value,depth:this.depthRate,rate:this.rate.value,resonance:this.lowpass.Q.value};return t}},{key:"toString",value:function(){return"[SoundModule Wah]"}}]),e}();e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),s=function(t){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return i.bass=t.createBiquadFilter(),i.middle=t.createBiquadFilter(),i.treble=t.createBiquadFilter(),i.presence=t.createBiquadFilter(),i.bass.type="string"==typeof i.bass.type?"lowshelf":i.bass.LOWSHELF||3,i.middle.type="string"==typeof i.middle.type?"peaking":i.middle.PEAKING||5,i.treble.type="string"==typeof i.treble.type?"peaking":i.treble.PEAKING||5,i.presence.type="string"==typeof i.presence.type?"highshelf":i.presence.HIGHSHELF||4,i.bass.frequency.value=500,i.middle.frequency.value=1e3,i.treble.frequency.value=2e3,i.presence.frequency.value=4e3,i.middle.Q.value=Math.SQRT1_2,i.treble.Q.value=Math.SQRT1_2,i.bass.gain.value=0,i.middle.gain.value=0,i.treble.gain.value=0,i.presence.gain.value=0,i.state(!1),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,e){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var r in arguments[0])this.param(r,arguments[0][r]);else{var i=String(t).replace(/-/g,"").toLowerCase(),n=null,s=null;switch(i){case"bass":case"middle":case"treble":case"presence":if(void 0===e)return this[i].gain.value;s=40,(n=parseFloat(e))>=-40&&n<=s&&(this[i].gain.value=n)}}return this}},{key:"connect",value:function(){return this.input.disconnect(0),this.bass.disconnect(0),this.middle.disconnect(0),this.treble.disconnect(0),this.presence.disconnect(0),this.isActive?(this.input.connect(this.bass),this.bass.connect(this.middle),this.middle.connect(this.treble),this.treble.connect(this.presence),this.presence.connect(this.output)):this.input.connect(this.output),this}},{key:"params",value:function(){var t={state:this.isActive,bass:this.bass.gain.value,middle:this.middle.gain.value,treble:this.treble.gain.value,presence:this.presence.gain.value};return t}},{key:"toString",value:function(){return"[SoundModule Equalizer]"}}]),e}();e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),s=function(t){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return i.filter=t.createBiquadFilter(),i.filter.frequency.setTargetAtTime=i.filter.frequency.setTargetAtTime||i.filter.frequency.setTargetValueAtTime,i.filter.type="string"==typeof i.filter.type?"lowpass":i.filter.LOWPASS||0,i.filter.frequency.value=350,i.filter.Q.value=1,i.filter.gain.value=0,i.maxFrequency=i.filter.frequency.value,i.range=.1,i.attack=.01,i.decay=.3,i.sustain=1,i.release=1,i.state(!1),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,r){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var i in arguments[0])this.param(i,arguments[0][i]);else{var n=String(t).replace(/-/g,"").toLowerCase(),s=null,a=null,o=null;switch(n){case"type":if(void 0===r)return this.filter.type;(s=String(r).toLowerCase())in e.FILTER_TYPES&&(this.filter.type="string"==typeof this.filter.type?s:e.FILTER_TYPES[s]);break;case"frequency":case"cutoff":if(void 0===r)return this.filter.frequency.value;s=parseFloat(r),a=10,o=this.context.sampleRate/2,s>=a&&s<=o&&(this.maxFrequency=s,this.filter.frequency.value=s);break;case"gain":if(void 0===r)return this.filter.gain.value;o=40,(s=parseFloat(r))>=(a=-40)&&s<=o&&(this.filter.gain.value=s);break;case"q":if(void 0===r)return this.filter.Q.value;o=1e3,(s=parseFloat(r))>=(a=1e-4)&&s<=o&&(this.filter.Q.value=s);break;case"range":if(void 0===r)return this.range;o=1,(s=parseFloat(r))>=(a=0)&&s<=o&&(this.range=s);break;case"attack":case"sustain":if(void 0===r)return this[n];(s=parseFloat(r))>=0&&(this[n]=s);break;case"decay":case"release":if(void 0===r)return this[n];(s=parseFloat(r))>0&&(this[n]=s)}}return this}},{key:"connect",value:function(){return this.input.disconnect(0),this.filter.disconnect(0),this.isActive?(this.input.connect(this.filter),this.filter.connect(this.output)):this.input.connect(this.output),this}},{key:"start",value:function(t){if(this.isActive){var e=parseFloat(t);(isNaN(e)||e<this.context.currentTime)&&(e=this.context.currentTime);var r=e,i=r+this.attack,n=this.decay,s=this.sustain*this.maxFrequency,a=this.maxFrequency*this.range;this.filter.frequency.cancelScheduledValues(r),this.filter.frequency.setValueAtTime(a,r),this.filter.frequency.linearRampToValueAtTime(this.maxFrequency,i),this.filter.frequency.setTargetAtTime(s,i,n)}return this}},{key:"stop",value:function(t){if(this.isActive){var e=parseFloat(t)-this.release;(isNaN(e)||e<this.context.currentTime)&&(e=this.context.currentTime);var r=e,i=this.release,n=this.maxFrequency*this.range;this.filter.frequency.cancelScheduledValues(r),this.filter.frequency.setValueAtTime(this.filter.frequency.value,r),this.filter.frequency.setTargetAtTime(n,r,i)}return this}},{key:"state",value:function(t){return void 0===t?this.isActive:("toggle"===String(t).toLowerCase()?this.isActive=!this.isActive:this.isActive=Boolean(t),this.connect(),this)}},{key:"params",value:function(){var t={state:this.isActive,type:this.filter.type,frequency:this.filter.frequency.value,Q:this.filter.Q.value,gain:this.filter.gain.value,range:this.range,attack:this.attack,decay:this.decay,sustain:this.sustain,release:this.release};return t}},{key:"toString",value:function(){return"[SoundModule Filter]"}}]),e}();s.FILTER_TYPES={lowpass:0,highpass:1,bandpass:2,lowshelf:3,highshelf:4,peaking:5,notch:6,allpass:7},e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),s=function(t){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return i.panner=t.createStereoPanner(),i.panner.pan.value=0,i.depth.gain.value=0,i.rate.value=0,i.state(!1),i.lfo.connect(i.depth),i.depth.connect(i.panner.pan),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,e){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var r in arguments[0])this.param(r,arguments[0][r]);else{var i=null,n=null,s=null;switch(String(t).replace(/-/g,"").toLowerCase()){case"depth":if(void 0===e)return this.depth.gain.value;s=1,(i=parseFloat(e))>=(n=0)&&i<=s&&(this.depth.gain.value=i);break;case"rate":if(void 0===e)return this.rate.value;i=parseFloat(e),n=0,s=this.context.sampleRate/2,i>=n&&i<=s&&(this.rate.value=i)}}return this}},{key:"connect",value:function(){return this.input.disconnect(0),this.panner.disconnect(0),this.isActive?(this.input.connect(this.panner),this.panner.connect(this.output)):this.input.connect(this.output),this}},{key:"stop",value:function(t,r){return function t(e,r,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,r);if(void 0===n){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"stop",this).call(this,t,r),this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.panner.pan)),this}},{key:"params",value:function(){var t={state:this.isActive,depth:this.depth.gain.value,rate:this.rate.value};return t}},{key:"toString",value:function(){return"[SoundModule Autopanner]"}}]),e}();e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),s=function(t){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return i.amplitudeL=t.createGain(),i.amplitudeR=t.createGain(),i.splitter=t.createChannelSplitter(2),i.merger=t.createChannelMerger(2),i.amplitudeL.gain.value=1,i.amplitudeR.gain.value=1,i.depth.gain.value=0,i.rate.value=0,i.state(!1),i.lfoSplitter=t.createChannelSplitter(2),i.lfo.connect(i.depth),i.depth.connect(i.processor),i.processor.connect(i.lfoSplitter),i.lfoSplitter.connect(i.amplitudeL.gain,0),i.lfoSplitter.connect(i.amplitudeR.gain,1),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,e){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var r in arguments[0])this.param(r,arguments[0][r]);else{var i=null,n=null,s=null;switch(String(t).replace(/-/g,"").toLowerCase()){case"depth":if(void 0===e)return this.depth.gain.value;s=1,(i=parseFloat(e))>=(n=0)&&i<=s&&(this.depth.gain.value=i);break;case"rate":if(void 0===e)return this.rate.value;i=parseFloat(e),n=0,s=this.context.sampleRate/2,i>=n&&i<=s&&(this.rate.value=i)}}return this}},{key:"connect",value:function(){return this.input.disconnect(0),this.amplitudeL.disconnect(0),this.amplitudeR.disconnect(0),this.splitter.disconnect(0),this.splitter.disconnect(1),this.merger.disconnect(0),this.isActive?(this.input.connect(this.splitter),this.splitter.connect(this.amplitudeL,0,0),this.splitter.connect(this.amplitudeR,1,0),this.amplitudeL.connect(this.merger,0,0),this.amplitudeR.connect(this.merger,0,1),this.merger.connect(this.output)):this.input.connect(this.output),this}},{key:"start",value:function(t){var e=this;if(this.isActive&&this.isStop){var r=parseFloat(t);(isNaN(r)||r<this.context.currentTime)&&(r=this.context.currentTime),this.lfo.start(r),this.isStop=!1;var i=this.processor.bufferSize;this.processor.onaudioprocess=function(t){var r=t.inputBuffer.getChannelData(0),n=t.outputBuffer.getChannelData(0),s=t.outputBuffer.getChannelData(1);if(e.isActive&&0!==e.depth.gain.value&&0!==e.rate.value)for(var a=0;a<i;a++)n[a]=r[a],s[a]=-r[a];else for(var o=0;o<i;o++)n[o]=0,s[o]=0}}return this}},{key:"stop",value:function(t,r){return function t(e,r,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,r);if(void 0===n){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"stop",this).call(this,t,r),this.isActive&&(this.processor.disconnect(0),this.processor.onaudioprocess=null,this.lfo.connect(this.depth),this.depth.connect(this.processor),this.processor.connect(this.lfoSplitter),this.lfoSplitter.connect(this.amplitudeL.gain,0),this.lfoSplitter.connect(this.amplitudeR.gain,1)),this}},{key:"params",value:function(){var t={state:this.isActive,depth:this.depth.gain.value,rate:this.rate.value};return t}},{key:"toString",value:function(){return"[SoundModule AutopannerFallback]"}}]),e}();e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),s=function(t){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return i.amplitude=t.createGain(),i.amplitude.gain.value=1,i.depth.gain.value=0,i.rate.value=0,i.state(!1),i.lfo.connect(i.depth),i.depth.connect(i.amplitude.gain),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,r){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var i in arguments[0])this.param(i,arguments[0][i]);else{var n=null,s=null,a=null;switch(String(t).replace(/-/g,"").toLowerCase()){case"depth":if(void 0===r)return this.depth.gain.value;a=1,(n=parseFloat(r))>=(s=0)&&n<=a&&(this.depth.gain.value=n);break;case"rate":if(void 0===r)return this.rate.value;n=parseFloat(r),s=0,a=this.context.sampleRate/2,n>=s&&n<=a&&(this.rate.value=n);break;case"wave":if(void 0===r)return this.lfo.type;(n=String(r).toLowerCase())in e.WAVE_TYPES&&(this.lfo.type="string"==typeof this.lfo.type?n:e.WAVE_TYPES[n])}}return this}},{key:"connect",value:function(){return this.input.disconnect(0),this.amplitude.disconnect(0),this.isActive?(this.input.connect(this.amplitude),this.amplitude.connect(this.output)):this.input.connect(this.output),this}},{key:"stop",value:function(t,r){return function t(e,r,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,r);if(void 0===n){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"stop",this).call(this,t,r),this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.amplitude.gain)),this}},{key:"params",value:function(){var t={state:this.isActive,depth:this.depth.gain.value,rate:this.rate.value,wave:this.lfo.type};return t}},{key:"toString",value:function(){return"[SoundModule Tremolo]"}}]),e}();s.WAVE_TYPES={sine:0,square:1,sawtooth:2,triangle:3},e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),s=function(t){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return i.amplitude=t.createGain(),i.amplitude.gain.value=0,i.depth.gain.value=1,i.rate.value=0,i.state(!1),i.lfo.connect(i.depth),i.depth.connect(i.amplitude.gain),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,e){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var r in arguments[0])this.param(r,arguments[0][r]);else{var i=null,n=null,s=null;switch(String(t).replace(/-/g,"").toLowerCase()){case"depth":if(void 0===e)return this.depth.gain.value;s=1,(i=parseFloat(e))>=(n=0)&&i<=s&&(this.depth.gain.value=i);break;case"rate":if(void 0===e)return this.rate.value;i=parseFloat(e),n=0,s=this.context.sampleRate/2,i>=n&&i<=s&&(this.rate.value=i)}}return this}},{key:"connect",value:function(){return this.input.disconnect(0),this.amplitude.disconnect(0),this.isActive?(this.input.connect(this.amplitude),this.amplitude.connect(this.output)):this.input.connect(this.output),this}},{key:"stop",value:function(t,r){return function t(e,r,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,r);if(void 0===n){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"stop",this).call(this,t,r),this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.amplitude.gain)),this}},{key:"params",value:function(){var t={state:this.isActive,depth:this.depth.gain.value,rate:this.rate.value};return t}},{key:"toString",value:function(){return"[SoundModule Ringmodulator]"}}]),e}();e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),s=function(t){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));i.numberOfStages=12,i.filters=new Array(e.MAXIMUM_STAGES);for(var n=0;n<e.MAXIMUM_STAGES;n++)i.filters[n]=t.createBiquadFilter(),i.filters[n].type="string"==typeof i.filters[n].type?"allpass":i.filters[n].ALLPASS||7,i.filters[n].frequency.value=350,i.filters[n].Q.value=1,i.filters[n].gain.value=0;i.mix=t.createGain(),i.feedback=t.createGain(),i.depth.gain.value=0,i.rate.value=0,i.mix.gain.value=0,i.feedback.gain.value=0,i.depthRate=0,i.state(!1),i.lfo.connect(i.depth);for(var s=0;s<e.MAXIMUM_STAGES;s++)i.depth.connect(i.filters[s].frequency);return i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,r){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var i in arguments[0])this.param(i,arguments[0][i]);else{var n=String(t).replace(/-/g,"").toLowerCase(),s=null,a=null,o=null;switch(n){case"stage":if(void 0===r)return this.numberOfStages;switch(s=parseInt(r,10)){case 0:case 2:case 4:case 8:case 12:case 24:this.numberOfStages=s,this.connect()}break;case"frequency":case"cutoff":if(void 0===r)return this.filters[0].frequency.value;if(s=parseFloat(r),a=10,o=this.context.sampleRate/2,s>=a&&s<=o){for(var l=0;l<e.MAXIMUM_STAGES;l++)this.filters[l].frequency.value=s;this.depth.gain.value=this.filters[0].frequency.value*this.depthRate}break;case"resonance":if(void 0===r)return this.filters[0].Q.value;if(s=parseFloat(r),a=1e-4,o=1e3,s>=a&&s<=o)for(var u=0;u<e.MAXIMUM_STAGES;u++)this.filters[0].Q.value=s;break;case"depth":if(void 0===r)return this.depthRate;o=1,(s=parseFloat(r))>=(a=0)&&s<=o&&(this.depth.gain.value=this.filters[0].frequency.value*s,this.depthRate=s);break;case"rate":if(void 0===r)return this.rate.value;s=parseFloat(r),a=0,o=this.context.sampleRate/2,s>=a&&s<=o&&(this.rate.value=s);break;case"mix":case"feedback":if(void 0===r)return this[n].gain.value;o=1,(s=parseFloat(r))>=(a=0)&&s<=o&&(this[n].gain.value=s)}}return this}},{key:"connect",value:function(){this.input.disconnect(0);for(var t=0;t<e.MAXIMUM_STAGES;t++)this.filters[t].disconnect(0);if(this.mix.disconnect(0),this.feedback.disconnect(0),this.input.connect(this.output),this.isActive&&this.numberOfStages>0){this.input.connect(this.filters[0]);for(var r=0;r<this.numberOfStages;r++)r<this.numberOfStages-1?this.filters[r].connect(this.filters[r+1]):(this.filters[r].connect(this.mix),this.mix.connect(this.output),this.filters[r].connect(this.feedback),this.feedback.connect(this.filters[0]))}return this}},{key:"stop",value:function(t,r){if(function t(e,r,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,r);if(void 0===n){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"stop",this).call(this,t,r),this.isActive){this.lfo.connect(this.depth);for(var i=0;i<e.MAXIMUM_STAGES;i++)this.depth.connect(this.filters[i].frequency)}return this}},{key:"params",value:function(){var t={state:this.isActive,stage:this.numberOfStages,frequency:this.filters[0].frequency.value,resonance:this.filters[0].Q.value,depth:this.depthRate,rate:this.rate.value,mix:this.mix.gain.value,feedback:this.feedback.gain.value};return t}},{key:"toString",value:function(){return"[SoundModule Phaser]"}}]),e}();s.MAXIMUM_STAGES=24,e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),s=function(t){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return i.delay=t.createDelay(),i.mix=t.createGain(),i.tone=t.createBiquadFilter(),i.feedback=t.createGain(),i.delay.delayTime.value=0,i.depth.gain.value=0,i.rate.value=0,i.mix.gain.value=0,i.tone.type="string"==typeof i.tone.type?"lowpass":i.tone.LOWPASS||0,i.tone.frequency.value=350,i.tone.Q.value=Math.SQRT1_2,i.tone.gain.value=0,i.feedback.gain.value=0,i.depthRate=0,i.state(!1),i.lfo.connect(i.depth),i.depth.connect(i.delay.delayTime),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,e){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var r in arguments[0])this.param(r,arguments[0][r]);else{var i=String(t).replace(/-/g,"").toLowerCase(),n=null,s=null,a=null;switch(i){case"delaytime":case"time":if(void 0===e)return this.delay.delayTime.value;a=1,(n=parseFloat(e))>=(s=0)&&n<=a&&(this.delay.delayTime.value=n,this.depth.gain.value=this.delay.delayTime.value*this.depthRate);break;case"depth":if(void 0===e)return this.depthRate;a=1,(n=parseFloat(e))>=(s=0)&&n<=a&&(this.depth.gain.value=this.delay.delayTime.value*n,this.depthRate=n);break;case"rate":if(void 0===e)return this.rate.value;n=parseFloat(e),s=0,a=this.context.sampleRate/2,n>=s&&n<=a&&(this.rate.value=n);break;case"mix":case"feedback":if(void 0===e)return this[i].gain.value;a=1,(n=parseFloat(e))>=(s=0)&&n<=a&&(this[i].gain.value=n);break;case"tone":if(void 0===e)return this.tone.frequency.value;n=parseFloat(e),s=10,a=this.context.sampleRate/2,n>=s&&n<=a&&(this.tone.frequency.value=n)}}return this}},{key:"connect",value:function(){return this.input.disconnect(0),this.delay.disconnect(0),this.mix.disconnect(0),this.tone.disconnect(0),this.feedback.disconnect(0),this.input.connect(this.output),this.isActive&&(this.input.connect(this.tone),this.tone.connect(this.delay),this.delay.connect(this.mix),this.mix.connect(this.output),this.delay.connect(this.feedback),this.feedback.connect(this.delay)),this}},{key:"stop",value:function(t,r){return function t(e,r,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,r);if(void 0===n){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"stop",this).call(this,t,r),this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.delay.delayTime)),this}},{key:"params",value:function(){var t={state:this.isActive,time:this.delay.delayTime.value,depth:this.depthRate,rate:this.rate.value,mix:this.mix.gain.value,tone:this.tone.frequency.value,feedback:this.feedback.gain.value};return t}},{key:"toString",value:function(){return"[SoundModule Flanger]"}}]),e}();e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),s=function(t){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return i.delay=t.createDelay(),i.mix=t.createGain(),i.tone=t.createBiquadFilter(),i.feedback=t.createGain(),i.delay.delayTime.value=0,i.depth.gain.value=0,i.rate.value=0,i.mix.gain.value=0,i.tone.type="string"==typeof i.tone.type?"lowpass":i.tone.LOWPASS||0,i.tone.frequency.value=350,i.tone.Q.value=Math.SQRT1_2,i.tone.gain.value=0,i.feedback.gain.value=0,i.depthRate=0,i.state(!1),i.lfo.connect(i.depth),i.depth.connect(i.delay.delayTime),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,e){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var r in arguments[0])this.param(r,arguments[0][r]);else{var i=String(t).replace(/-/g,"").toLowerCase(),n=null,s=null,a=null;switch(i){case"delaytime":case"time":if(void 0===e)return this.delay.delayTime.value;a=1,(n=parseFloat(e))>=(s=0)&&n<=a&&(this.delay.delayTime.value=n,this.depth.gain.value=this.delay.delayTime.value*this.depthRate);break;case"depth":if(void 0===e)return this.depthRate;a=1,(n=parseFloat(e))>=(s=0)&&n<=a&&(this.depth.gain.value=this.delay.delayTime.value*n,this.depthRate=n);break;case"rate":if(void 0===e)return this.rate.value;n=parseFloat(e),s=0,a=this.context.sampleRate/2,n>=s&&n<=a&&(this.rate.value=n);break;case"mix":case"feedback":if(void 0===e)return this[i].gain.value;a=1,(n=parseFloat(e))>=(s=0)&&n<=a&&(this[i].gain.value=n);break;case"tone":if(void 0===e)return this.tone.frequency.value;n=parseFloat(e),s=10,a=this.context.sampleRate/2,n>=s&&n<=a&&(this.tone.frequency.value=n)}}return this}},{key:"connect",value:function(){return this.input.disconnect(0),this.delay.disconnect(0),this.mix.disconnect(0),this.tone.disconnect(0),this.feedback.disconnect(0),this.input.connect(this.output),this.isActive&&(this.input.connect(this.tone),this.tone.connect(this.delay),this.delay.connect(this.mix),this.mix.connect(this.output),this.delay.connect(this.feedback),this.feedback.connect(this.delay)),this}},{key:"stop",value:function(t,r){return function t(e,r,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,r);if(void 0===n){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,r,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"stop",this).call(this,t,r),this.isActive&&(this.lfo.connect(this.depth),this.depth.connect(this.delay.delayTime)),this}},{key:"params",value:function(){var t={state:this.isActive,time:this.delay.delayTime.value,depth:this.depthRate,rate:this.rate.value,mix:this.mix.gain.value,tone:this.tone.frequency.value,feedback:this.feedback.gain.value};return t}},{key:"toString",value:function(){return"[SoundModule Chorus]"}}]),e}();e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),s=function(t){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return i.delay=t.createDelay(e.MAX_DELAY_TIME),i.dry=t.createGain(),i.wet=t.createGain(),i.tone=t.createBiquadFilter(),i.feedback=t.createGain(),i.delay.delayTime.value=0,i.dry.gain.value=1,i.wet.gain.value=0,i.tone.type="string"==typeof i.tone.type?"lowpass":i.tone.LOWPASS||0,i.tone.frequency.value=350,i.tone.Q.value=Math.SQRT1_2,i.tone.gain.value=0,i.feedback.gain.value=0,i.state(!1),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,r){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var i in arguments[0])this.param(i,arguments[0][i]);else{var n=String(t).replace(/-/g,"").toLowerCase(),s=null,a=null,o=null;switch(n){case"delaytime":case"time":if(void 0===r)return this.delay.delayTime.value;s=parseFloat(r),o=e.MAX_DELAY_TIME,s>=(a=0)&&s<=o&&(this.delay.delayTime.value=s);break;case"dry":case"wet":case"feedback":if(void 0===r)return this[n].gain.value;o=1,(s=parseFloat(r))>=(a=0)&&s<=o&&(this[n].gain.value=s);break;case"tone":if(void 0===r)return this.tone.frequency.value;s=parseFloat(r),a=10,o=this.context.sampleRate/2,s>=a&&s<=o&&(this.tone.frequency.value=s)}}return this}},{key:"connect",value:function(){return this.input.disconnect(0),this.delay.disconnect(0),this.dry.disconnect(0),this.wet.disconnect(0),this.tone.disconnect(0),this.feedback.disconnect(0),this.isActive?(this.input.connect(this.dry),this.dry.connect(this.output),this.input.connect(this.tone),this.tone.connect(this.delay),this.delay.connect(this.wet),this.wet.connect(this.output),this.delay.connect(this.feedback),this.feedback.connect(this.delay)):this.input.connect(this.output),this}},{key:"params",value:function(){var t={state:this.isActive,time:this.delay.delayTime.value,dry:this.dry.gain.value,wet:this.wet.gain.value,tone:this.tone.frequency.value,feedback:this.feedback.gain.value};return t}},{key:"toString",value:function(){return"[SoundModule Delay]"}}]),e}();s.MAX_DELAY_TIME=5,e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),s=function(t){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return i.rirs=[],i.convolver=t.createConvolver(),i.dry=t.createGain(),i.wet=t.createGain(),i.tone=t.createBiquadFilter(),i.dry.gain.value=1,i.wet.gain.value=0,i.tone.type="string"==typeof i.tone.type?"lowpass":i.tone.LOWPASS||0,i.tone.frequency.value=350,i.tone.Q.value=Math.SQRT1_2,i.tone.gain.value=0,i.state(!1),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,e){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var r in arguments[0])this.param(r,arguments[0][r]);else{var i=String(t).replace(/-/g,"").toLowerCase(),n=null,s=null,a=null;switch(i){case"type":if(void 0===e)return this.convolver.buffer;n=parseInt(e,10),s=0,a=this.rirs.length-1,null===e?(this.convolver.buffer=null,this.input.disconnect(0),this.input.connect(this.output)):n>=s&&n<=a&&(this.convolver.buffer=this.rirs[n],this.connect());break;case"dry":case"wet":if(void 0===e)return this[i].gain.value;a=1,(n=parseFloat(e))>=(s=0)&&n<=a&&(this[i].gain.value=n);break;case"tone":if(void 0===e)return this.tone.frequency.value;n=parseFloat(e),s=10,a=this.context.sampleRate/2,n>=s&&n<=a&&(this.tone.frequency.value=n);break;case"rirs":return this.rirs}}return this}},{key:"connect",value:function(){return this.input.disconnect(0),this.convolver.disconnect(0),this.dry.disconnect(0),this.wet.disconnect(0),this.tone.disconnect(0),this.isActive?(this.input.connect(this.dry),this.dry.connect(this.output),this.input.connect(this.tone),this.tone.connect(this.convolver),this.convolver.connect(this.wet),this.wet.connect(this.output)):this.input.connect(this.output),this}},{key:"start",value:function(t,e){var r=this;if(t instanceof AudioBuffer||null===t)this.convolver.buffer=t,this.rirs.push(t);else if(t instanceof ArrayBuffer){var i=function(t){r.convolver.buffer=t,r.rirs.push(t)};"[object Function]"!==Object.prototype.toString.call(e)&&(e=function(){}),this.context.decodeAudioData(t,i,e)}return this}},{key:"preset",value:function(t,r,i,n,s){var a=this;if("[object Object]"===Object.prototype.toString.call(arguments[0])){var o=arguments[0];"rirs"in o&&(t=o.rirs),"timeout"in o&&(r=o.timeout),"success"in o&&(i=o.success),"error"in o&&(n=o.error),"progress"in o&&(s=o.progress)}Array.isArray(t)||(t=[t]),this.rirs=new Array(t.length);for(var l=!1,u=parseInt(r,10),c=function(t,r){var o=new XMLHttpRequest;o.timeout=u>0?u:6e4,o.ontimeout=function(t){l||"[object Function]"!==Object.prototype.toString.call(n)||n(t,e.ERROR_AJAX_TIMEOUT),l=!0},o.onprogresss=function(t){l?o.abort():"[object Function]"===Object.prototype.toString.call(s)&&s(t)},o.onerror=function(t){l||"[object Function]"!==Object.prototype.toString.call(n)||n(t,e.ERROR_AJAX),l=!0},o.onload=function(t){if(200===o.status){var s=o.response;if(!(s instanceof ArrayBuffer))return;var l=function(e){a.rirs[r]=e;for(var n=0,s=a.rirs.length;n<s;n++)if(void 0===a.rirs[n])return;"[object Function]"===Object.prototype.toString.call(i)&&i(t)},u=function(t){"[object Function]"===Object.prototype.toString.call(n)&&n(t,e.ERROR_DECODE)};a.context.decodeAudioData(s,l,u)}},o.open("GET",t,!0),o.responseType="arraybuffer",o.send(null)},f=0,h=t.length;f<h;f++)"string"==typeof t[f]?c(t[f],f):t[f]instanceof AudioBuffer&&(this.rirs[f]=t[f]);return this}},{key:"state",value:function(t){return void 0===t?this.isActive:("toggle"===String(t).toLowerCase()?this.isActive=!this.isActive:this.isActive=Boolean(t),this.connect(),this)}},{key:"params",value:function(){var t={state:this.isActive,dry:this.dry.gain.value,wet:this.wet.gain.value,tone:this.tone.frequency.value};return t}},{key:"toString",value:function(){return"[SoundModule Reverb]"}}]),e}();s.ERROR_AJAX="error",s.ERROR_AJAX_TIMEOUT="timeout",s.ERROR_DECODE="decode",e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),s=function(t){function e(t,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return i.panner=t.createPanner(),i.positions={x:0,y:0,z:0},i.orientations={x:1,y:0,z:0},i.panner.refDistance=1,i.panner.maxDistance=1e4,i.panner.rolloffFactor=1,i.panner.coneInnerAngle=360,i.panner.coneOuterAngle=360,i.panner.coneOuterGain=0,i.panner.panningModel="string"==typeof i.panner.panningModel?"HRTF":i.panner.HRTF||1,i.panner.distanceModel="string"==typeof i.panner.distanceModel?"inverse":i.panner.INVERSE_DISTANCE||1,i.panner.setPosition(i.positions.x,i.positions.y,i.positions.z),i.panner.setOrientation(i.orientations.x,i.orientations.y,i.orientations.z),i.state(!1),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,n.default),i(e,[{key:"param",value:function(t,r){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var i in arguments[0])this.param(i,arguments[0][i]);else{var n=String(t).replace(/-/g,"").toLowerCase(),s=null;switch(n){case"x":case"y":case"z":if(void 0===r)return this.positions[n];s=parseFloat(r),isNaN(s)||(this.positions[n]=s,this.panner.setPosition(this.positions.x,this.positions.y,this.positions.z));break;case"ox":case"oy":case"oz":if(void 0===r)return this.orientations[n.charAt(1)];s=parseFloat(r),isNaN(s)||(this.orientations[n.charAt(1)]=s,this.panner.setOrientation(this.orientations.x,this.orientations.y,this.orientations.z));break;case"refdistance":if(void 0===r)return this.panner.refDistance;(s=parseFloat(r))>=0&&(this.panner.refDistance=s);break;case"maxdistance":if(void 0===r)return this.panner.maxDistance;(s=parseFloat(r))>0&&(this.panner.maxDistance=s);break;case"rollofffactor":if(void 0===r)return this.panner.rolloffFactor;s=parseFloat(r),isNaN(s)||(this.panner.rolloffFactor=s);break;case"coneinnerangle":if(void 0===r)return this.panner.coneInnerAngle;s=parseFloat(r),isNaN(s)||(this.panner.coneInnerAngle=s);break;case"coneouterangle":if(void 0===r)return this.panner.coneOuterAngle;s=parseFloat(r),isNaN(s)||(this.panner.coneOuterAngle=s);break;case"coneoutergain":if(void 0===r)return this.panner.coneOuterGain;s=parseFloat(r),isNaN(s)||(this.panner.coneOuterGain=s);break;case"panningmodel":if(void 0===r)return this.panner.panningModel;(s=/HRTF/i.test(r)?String(r).toUpperCase():String(r).toLowerCase())in e.PANNING_MODELS&&(this.panner.panningModel="string"==typeof this.panner.panningModel?s:e.PANNING_MODELS[s]);break;case"distancemodel":if(void 0===r)return this.panner.distanceModel;(s=String(r).replace(/-/g,"").toLowerCase())in e.DISTANCE_MODELS&&(this.panner.distanceModel="string"==typeof this.panner.distanceModel?s:e.DISTANCE_MODELS[s])}}return this}},{key:"connect",value:function(){return this.input.disconnect(0),this.panner.disconnect(0),this.isActive?(this.input.connect(this.panner),this.panner.connect(this.output)):this.input.connect(this.output),this}},{key:"params",value:function(){var t={state:this.isActive,positions:this.positions,orientations:this.orientations,refDistance:this.panner.refDistance,maxDistance:this.panner.maxDistance,rolloffFactor:this.panner.rolloffFactor,coneInnerAngle:this.panner.coneInnerAngle,coneOuterAngle:this.panner.coneOuterAngle,coneOuterGain:this.panner.coneOuterGain,panningModel:this.panner.panningModel,distanceModel:this.panner.distanceModel};return t}},{key:"toString",value:function(){return"[SoundModule Panner]"}}]),e}();s.PANNING_MODELS={equalpower:0,HRTF:1},s.DISTANCE_MODELS={linear:0,inverse:1,exponential:2},e.default=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.listener=e.listener,this.positions={x:0,y:0,z:0},this.fronts={x:0,y:0,z:-1},this.ups={x:0,y:1,z:0},this.listener.setPosition(this.positions.x,this.positions.y,this.positions.z),this.listener.setOrientation(this.fronts.x,this.fronts.y,this.fronts.z,this.ups.x,this.ups.y,this.ups.z)}return i(t,[{key:"param",value:function(t,e){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var r in arguments[0])this.param(r,arguments[0][r]);else{var i=String(t).replace(/-/g,"").toLowerCase(),n=null;switch(i){case"x":case"y":case"z":if(void 0===e)return this.positions[i];n=parseFloat(e),isNaN(n)||(this.positions[i]=n,this.listener.setPosition(this.positions.x,this.positions.y,this.positions.z));break;case"fx":case"fy":case"fz":if(void 0===e)return this.fronts[i.charAt(1)];n=parseFloat(e),isNaN(n)||(this.fronts[i.charAt(1)]=n,this.listener.setOrientation(this.fronts.x,this.fronts.y,this.fronts.z,this.ups.x,this.ups.y,this.ups.z));break;case"ux":case"uy":case"uz":if(void 0===e)return this.ups[i.charAt(1)];n=parseFloat(e),isNaN(n)||(this.ups[i.charAt(1)]=n,this.listener.setOrientation(this.fronts.x,this.fronts.y,this.fronts.z,this.ups.x,this.ups.y,this.ups.z))}}return this}},{key:"params",value:function(){var t={positions:this.positions,fronts:this.fronts,ups:this.ups};return t}},{key:"toJSON",value:function(){return JSON.stringify(this.params())}},{key:"toString",value:function(){return"[SoundModule Listener]"}}]),t}();e.default=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e,this.generators=[],this.activeIndexes=[],this.activeCounter=0,this.attack=.01,this.decay=.3,this.sustain=.5,this.release=1}return i(t,[{key:"param",value:function(t,e){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var r in arguments[0])this.param(r,arguments[0][r]);else{var i=String(t).replace(/-/g,"").toLowerCase(),n=null;switch(i){case"attack":case"sustain":if(void 0===e)return this[i];(n=parseFloat(e))>=0&&(this[i]=n);break;case"decay":case"release":if(void 0===e)return this[i];(n=parseFloat(e))>0&&(this[i]=n)}}return this}},{key:"ready",value:function(t,e,r){var i=parseInt(t,10)>=0?parseInt(t,10):0;return e.connect(this.generators[i]),this.generators[i].connect(r),this.activeIndexes[i]=i,this.activeCounter++,this}},{key:"start",value:function(t){var e=parseFloat(t);(isNaN(e)||e<this.context.currentTime)&&(e=this.context.currentTime);var r=e,i=r+this.attack,n=this.decay,s=this.sustain,a=!0,o=!1,l=void 0;try{for(var u,c=this.activeIndexes[Symbol.iterator]();!(a=(u=c.next()).done);a=!0){var f=u.value;void 0!==f&&(this.generators[f].gain.cancelScheduledValues(r),this.generators[f].gain.setValueAtTime(0,r),this.generators[f].gain.linearRampToValueAtTime(1,i),this.generators[f].gain.setTargetAtTime(s,i,n))}}catch(t){o=!0,l=t}finally{try{!a&&c.return&&c.return()}finally{if(o)throw l}}return this}},{key:"stop",value:function(t){var e=parseFloat(t)-this.release;(isNaN(e)||e<this.context.currentTime)&&(e=this.context.currentTime);var r=e,i=this.release,n=!0,s=!1,a=void 0;try{for(var o,l=this.activeIndexes[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var u=o.value;void 0!==u&&(this.generators[u].gain.cancelScheduledValues(r),this.generators[u].gain.setValueAtTime(this.generators[u].gain.value,r),this.generators[u].gain.setTargetAtTime(0,r,i))}}catch(t){s=!0,a=t}finally{try{!n&&l.return&&l.return()}finally{if(s)throw a}}return this}},{key:"getGenerator",value:function(t){var e=parseInt(t,10)>=0?parseInt(t,10):0;return this.generators[e]}},{key:"setGenerator",value:function(t){var e=parseInt(t,10)>=0?parseInt(t,10):0;return this.generators[e]=this.context.createGain(),this.generators[e].gain.setTargetAtTime=this.generators[e].gain.setTargetAtTime||this.generators[e].gain.setTargetValueAtTime,this}},{key:"isStop",value:function(){var e=0,r=!0,i=!1,n=void 0;try{for(var s,a=this.activeIndexes[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var o=s.value;if(void 0!==o){if(this.generators[o].gain.value>t.MIN_GAIN)return!1;if(++e===this.activeCounter)return!0}}}catch(t){i=!0,n=t}finally{try{!r&&a.return&&a.return()}finally{if(i)throw n}}}},{key:"clear",value:function(t){this.activeIndexes.length=0,this.activeCounter=0;var e=!0,r=!1,i=void 0;try{for(var n,s=this.generators[Symbol.iterator]();!(e=(n=s.next()).done);e=!0){var a=n.value;a.gain.cancelScheduledValues(this.context.currentTime),a.gain.value=1,t&&a.disconnect(0)}}catch(t){r=!0,i=t}finally{try{!e&&s.return&&s.return()}finally{if(r)throw i}}return this}},{key:"params",value:function(){var t={attack:this.attack,decay:this.decay,sustain:this.sustain,release:this.release};return t}},{key:"toJSON",value:function(){return JSON.stringify(this.params())}},{key:"toString",value:function(){return"[SoundModule EnvelopeGenerator]"}}]),t}();n.MIN_GAIN=.001,e.default=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.isActive=r,this.context=e,this.source=e.createOscillator(),this.source.setPeriodicWave=this.source.setPeriodicWave||this.source.setWaveTable,this.source.start=this.source.start||this.source.noteOn,this.source.stop=this.source.stop||this.source.noteOff,this.volume=e.createGain(),this.isStop=!0,this.octave=0,this.fine=0,this.customs={real:new Float32Array([0,1]),imag:new Float32Array([0,1])}}return i(t,[{key:"param",value:function(e,r){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var i in arguments[0])this.param(i,arguments[0][i]);else{var n=null,s=null;switch(String(e).replace(/-/g,"").toLowerCase()){case"type":if(void 0===r)return this.source.type;if("[object Object]"!==Object.prototype.toString.call(r))(n=String(r).toLowerCase())in t.WAVE_TYPES&&(this.source.type="string"==typeof this.source.type?n:t.WAVE_TYPES[n]);else if("real"in r&&"imag"in r){var a=null,o=null;if(r.real instanceof Float32Array?a=r.real:Array.isArray(r.real)&&(a=new Float32Array(r.real)),r.imag instanceof Float32Array?o=r.imag:Array.isArray(r.imag)&&(o=new Float32Array(r.imag)),a instanceof Float32Array&&o instanceof Float32Array){a.length>4096&&(a=a.subarray(0,4096)),o.length>4096&&(o=o.subarray(0,4096)),0!==a[0]&&(a[0]=0),0!==o[0]&&(o[0]=0);var l=this.context.createPeriodicWave(a,o);this.source.setPeriodicWave(l),this.customs.real=a,this.customs.imag=o}}break;case"octave":if(void 0===r)return this.octave;n=parseFloat(r),s=4800/t.OCTAVE,n>=-4800/t.OCTAVE&&n<=s&&(this.octave=n,this.source.detune.value=this.fine+n*t.OCTAVE);break;case"fine":if(void 0===r)return this.fine;n=parseFloat(r),s=t.OCTAVE,n>=-t.OCTAVE&&n<=s&&(this.fine=n,this.source.detune.value=n+this.octave*t.OCTAVE);break;case"volume":case"gain":if(void 0===r)return this.volume.gain.value;s=1,(n=parseFloat(r))>=0&&n<=s&&(this.volume.gain.value=n)}}return this}},{key:"ready",value:function(t){if(this.isActive){var e={type:this.source.type,frequency:this.source.frequency.value,detune:this.source.detune.value};if(this.isStop||(this.source.stop(this.context.currentTime),this.source.disconnect(0)),this.source=this.context.createOscillator(),this.source.setPeriodicWave=this.source.setPeriodicWave||this.source.setWaveTable,this.source.start=this.source.start||this.source.noteOn,this.source.stop=this.source.stop||this.source.noteOff,"custom"===e.type){var r=this.customs.real,i=this.customs.imag,n=this.context.createPeriodicWave(r,i);this.source.setPeriodicWave(n)}else this.source.type=e.type;this.source.frequency.value=e.frequency,this.source.detune.value=e.detune,this.volume.connect(t)}return this}},{key:"start",value:function(t){return this.isActive?(this.source.start(t),this.isStop=!1):(this.isStop||(this.source.stop(this.context.currentTime),this.isStop=!0),this.source.disconnect(0)),this}},{key:"stop",value:function(t){return this.isStop||(this.source.stop(t),this.source.disconnect(0),this.isStop=!0),this}},{key:"state",value:function(t){return void 0===t?this.isActive:("toggle"===String(t).toLowerCase()?this.isActive=!this.isActive:this.isActive=Boolean(t),this)}},{key:"get",value:function(){return this.source}},{key:"toString",value:function(){return"[OscillatorModule Oscillator]"}}]),t}();n.OCTAVE=1200,n.WAVE_TYPES={sine:0,square:1,sawtooth:2,triangle:3},e.default=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e,this.frequencies={start:-1,end:0},this.time=0,this.type=t.LINEAR}return i(t,[{key:"param",value:function(e,r){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var i in arguments[0])this.param(i,arguments[0][i]);else{var n=null;switch(String(e).replace(/-/g,"").toLowerCase()){case"time":if(void 0===r)return this.time;(n=parseFloat(r))>=0&&(this.time=n);break;case"type":if(void 0===r)return this.type;(n=String(r).toLowerCase())!==t.LINEAR&&n!==t.EXPONENTIAL||(this.type=n)}}return this}},{key:"ready",value:function(t){this.frequencies.end=t;var e=-1===this.frequencies.start?0:this.frequencies.end-this.frequencies.start;return-1!==this.frequencies.start&&0!==this.time&&0!==e||(this.frequencies.start=this.frequencies.end),this}},{key:"start",value:function(t,e){var r=parseFloat(e);(isNaN(r)||r<this.context.currentTime)&&(r=this.context.currentTime);var i=r,n=i+this.time;return t.frequency.cancelScheduledValues(i),t.frequency.setValueAtTime(this.frequencies.start,i),t.frequency[this.type+"RampToValueAtTime"](this.frequencies.end,n),this}},{key:"stop",value:function(){return this.frequencies.start=this.frequencies.end,this}},{key:"toString",value:function(){return"[OscillatorModule Glide]"}}]),t}();n.LINEAR="linear",n.EXPONENTIAL="exponential",e.default=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.depth=0}return i(t,[{key:"param",value:function(t,e){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var r in arguments[0])this.param(r,arguments[0][r]);else{var i=null,n=null;switch(String(t).replace(/-/g,"").toLowerCase()){case"depth":if(void 0===e)return this.depth;n=1,(i=parseFloat(e))>=0&&i<=n&&(this.depth=i)}}return this}},{key:"start",value:function(t,e){return t-this.depth*e}},{key:"toString",value:function(){return"[AudioModule VocalCanceler]"}}]),t}();e.default=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.level=0}return i(t,[{key:"param",value:function(t,e){if("[object Object]"===Object.prototype.toString.call(arguments[0]))for(var r in arguments[0])this.param(r,arguments[0][r]);else{var i=null,n=null;switch(String(t).replace(/-/g,"").toLowerCase()){case"level":if(void 0===e)return this.level;n=1,(i=parseFloat(e))>=0&&i<=n&&(this.level=i)}}return this}},{key:"start",value:function(t){return Math.abs(parseFloat(t))>this.level?t:0}},{key:"toString",value:function(){return"[StreamModule NoiseGate]"}}]),t}();e.default=n},function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),s=i(r(1)),a=i(r(3)),o=i(r(4)),l=i(r(5)),u=i(r(6)),c=i(r(7)),f=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r.sources=[],r.isAnalyser=!1,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),n(e,[{key:"mix",value:function(t){var e=this;Array.isArray(t)||(t=[t]),this.sources=t;var r=!0,i=!1,n=void 0;try{for(var s,f=this.sources[Symbol.iterator]();!(r=(s=f.next()).done);r=!0){var h=s.value;if(!(h instanceof a.default||h instanceof o.default||h instanceof l.default||h instanceof u.default||h instanceof c.default))return this;var p=this.context.currentTime;this.off(p,!1),h.analyser.stop("time"),h.analyser.stop("fft"),h.isAnalyser=!1,h.recorder.stop(),h.session.close(),h.processor.disconnect(0),h.processor.connect(this.processor)}}catch(t){i=!0,n=t}finally{try{!r&&f.return&&f.return()}finally{if(i)throw n}}this.connect(this.processor);var y=this.context.currentTime;return this.on(y),this.isAnalyser||(this.analyser.start("time"),this.analyser.start("fft"),this.isAnalyser=!0),this.processor.onaudioprocess=function(r){var i=r.inputBuffer.getChannelData(0),n=r.inputBuffer.getChannelData(1),s=r.outputBuffer.getChannelData(0),f=r.outputBuffer.getChannelData(1),h=!1,p=!0,y=!1,d=void 0;try{for(var v,b=t[Symbol.iterator]();!(p=(v=b.next()).done);p=!0){var m=v.value;m instanceof a.default&&m.envelopegenerator.isStop()?h=!0:m instanceof o.default&&m.isStop?h=!0:m instanceof l.default&&m.paused?h=!0:m instanceof u.default&&m.media.paused?h=!0:m instanceof c.default&&m.isStop&&(h=!0)}}catch(t){y=!0,d=t}finally{try{!p&&b.return&&b.return()}finally{if(y)throw d}}if(h){var g=e.context.currentTime;e.on(g,!0),e.analyser.stop("time"),e.analyser.stop("fft"),e.isAnalyser=!1,e.processor.disconnect(0),e.processor.onaudioprocess=null}else s.set(i),f.set(n)},this}},{key:"get",value:function(t){var e=parseInt(t,10);return e>=0&&e<this.sources.length?this.sources[e]:this.sources}},{key:"toString",value:function(){return"[MixerModule]"}}]),e}();e.default=f},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e,this.midiAccess=null,this.inputs=[],this.outputs=[]}return i(t,[{key:"setup",value:function(t,e,r){var i=this;if(!navigator.requestMIDIAccess)throw new Error("Cannot use Web MIDI API.");return navigator.requestMIDIAccess({sysex:Boolean(t)}).then(function(t){if(i.midiAccess=t,"[object Function]"===Object.prototype.toString.call(t))i.inputs=t.inputs(),i.outputs=t.outputs();else{for(var r=t.inputs.values(),n=t.outputs.values(),s=r.next();!s.done;s=r.next())i.inputs.push(s.value);for(var a=n.next();!a.done;a=n.next())i.outputs.push(a.value)}"[object Function]"===Object.prototype.toString.call(e)&&e(i.midiAccess,i.inputs,i.outputs)}).catch(function(t){"[object Function]"===Object.prototype.toString.call(r)&&r(t)}),this}},{key:"get",value:function(){return this.midiAccess}},{key:"toString",value:function(){return"[MIDI]"}}]),t}();e.default=n},function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,r,i){return r&&t(e.prototype,r),i&&t(e,i),e}}(),s=i(r(3)),a=i(r(4)),o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.context=e,this.source=null,this.sequences=[],this.timerids=[],this.prev=[],this.callbacks={start:function(){},stop:function(){},ended:function(){},error:function(){}}}return n(t,[{key:"setup",value:function(t,e){if(arguments.length>0&&"[object Object]"===Object.prototype.toString.call(arguments[0]))for(var r in arguments[0])this.setup(r,arguments[0][r]);else if(arguments.length>1){var i=String(t).toLowerCase();i in this.callbacks&&"[object Function]"===Object.prototype.toString.call(e)&&(this.callbacks[i]=e)}return this}},{key:"ready",value:function(e,r){if(null!==this.source&&this.stop(),this.sequences.length=0,this.timerids.length=0,this.prev.length=0,Array.isArray(e)){var i=!0,n=!1,o=void 0;try{for(var l,u=e[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){if(!(l.value instanceof OscillatorNode))return this}}catch(t){n=!0,o=t}finally{try{!i&&u.return&&u.return()}finally{if(n)throw o}}this.source=e}else if(e instanceof OscillatorNode)this.source=[e];else{if(!(e instanceof s.default||e instanceof a.default))return this;this.source=e}for(Array.isArray(r)||(r=[r]);r.length>0;){var c=[],f=String(r.shift()).match(t.REGEXP_MML);if(null===f)return void this.callbacks.error(t.ERROR_STRING,"");for(var h=[],p=[],y=0,d=0,v=0,b=0,m=null,g=null;f.length>0;){var w=f.shift().trim();if(t.REGEXP_TEMPO.test(w)){var O=parseInt(w.slice(1),10);if(!(O>0))return void this.callbacks.error(t.ERROR_TEMPO,w);m=t.ONE_MINUTES/O}else if(t.REGEXP_OCTAVE.test(w)){if((g=parseInt(w.slice(1),10))<0)return void this.callbacks.error(t.ERROR_OCTAVE,w)}else if(t.REGEXP_NOTE.test(w)){if(null===m)return void this.callbacks.error(t.ERROR_TEMPO,w);if(null===g)return void this.callbacks.error(t.ERROR_OCTAVE,w);var S=w.match(t.REGEXP_CHORD)[1];h=[];for(var A=0,k=S.length;A<k;A++){var _=S.charAt(A),T=t.computeIndex(g,_.toUpperCase());switch(S.charAt(A+1)){case"#":case"+":T++,A++;break;case"-":T--,A++}if(T>=h[0]&&(T-=t.EQUAL_TEMPERAMENT),T<0)return void this.callbacks.error(t.ERROR_NOTE,w);h.push(T)}p=[];var j=!0,E=!1,x=void 0;try{for(var M,R=h[Symbol.iterator]();!(j=(M=R.next()).done);j=!0){var F=M.value,C=F!==t.REST?t.computeFrequency(F):0;if(-1===C)return void this.callbacks.error(t.ERROR_NOTE,w);p.push(C)}}catch(t){E=!0,x=t}finally{try{!j&&R.return&&R.return()}finally{if(E)throw x}}for(var P=w.split("&");P.length>0;){var N=P.shift().match(t.REGEXP_DURATION)[1];switch(parseInt(N,10)){case 1:case 2:case 4:case 8:case 16:case 32:case 64:case 128:case 256:var L=t.QUARTER_NOTE/parseInt(N,10);d+=-1!==N.indexOf(".")?1.5*L*m:L*m;break;case 6:d+=2*m/3;break;case 12:d+=m/3;break;case 18:d+=2*m/9;break;case 24:d+=.5*m/3;break;case 36:d+=m/9;break;case 48:d+=.25*m/3;break;case 72:d+=.5*m/9;break;case 96:d+=.125*m/3;break;case 144:d+=.25*m/9;break;case 192:d+=.0625*m/3;break;default:this.callbacks.error(t.ERROR_NOTE,w)}}v=(y=b)+d,b+=d,c.push({indexes:h,frequencies:p,start:y,duration:d,stop:v}),d=0}}c.length>0&&(c.reverse(),this.sequences.push(c),this.timerids.push(null))}return this}},{key:"start",value:function(e,r,i){var n=this,o=parseInt(e,10);if(o>=0&&o<this.sequences.length){if(!Array.isArray(this.sequences[o]))return this;if(0===this.sequences[o].length)return this.stop(i),this.callbacks.ended(),this;var l=this.sequences[o].pop();if(Array.isArray(this.source)){for(var u=0,c=this.source.length;u<c;u++){var f=this.source[u],h=f.type,p=f.detune.value;if(f=this.context.createOscillator(),f.start=f.start||f.noteOn,f.stop=f.stop||f.noteOff,f.type=h,f.frequency.value=l.frequencies[u],f.detune.value=p,Array.isArray(r)){f.connect(r[0]);for(var y=0,d=r.length;y<d;y++){var v=r[y];if(y<d-1){var b=r[y+1];if(!(v instanceof AudioNode&&b instanceof AudioNode))return this;v.connect(b)}else v.connect(this.context.destination)}}else f.connect(this.context.destination);f.start(this.context.currentTime),f.stop(this.context.currentTime+l.duration),this.source[u]=f}for(var m=0,g=l.indexes.length;m<g;m++)this.callbacks.start(l,m)}else if(this.source instanceof s.default){this.source.start(l.frequencies,r,i);for(var w=0,O=l.indexes.length;w<O;w++)this.callbacks.start(l,w)}else if(this.source instanceof a.default)for(var S=0,A=l.indexes.length;S<A;S++)l.indexes[S]!==t.REST&&this.source.start(l.indexes[S],r,i),this.callbacks.start(l,S);this.timerids[o]=window.setTimeout(function(){if(Array.isArray(n.source))for(var e=0,u=l.indexes.length;e<u;e++)n.callbacks.start(l,e);else if(n.source instanceof s.default){n.source.stop();for(var c=0,f=l.indexes.length;c<f;c++)n.callbacks.stop(l,c)}else if(n.source instanceof a.default)for(var h=0,p=l.indexes.length;h<p;h++)l.indexes[h]!==t.REST&&n.source.stop(l.indexes[h],i),n.callbacks.stop(l,h);n.prev=l,n.start(o,r,i)},1e3*l.duration)}return this}},{key:"stop",value:function(e){var r=this.prev;if(0===r.length)return this;if(Array.isArray(this.source)){var i=!0,n=!1,o=void 0;try{for(var l,u=r.indexes[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var c=l.value;this.callbacks.stop(r,c)}}catch(t){n=!0,o=t}finally{try{!i&&u.return&&u.return()}finally{if(n)throw o}}}else if(this.source instanceof s.default){this.source.stop();var f=!0,h=!1,p=void 0;try{for(var y,d=r.indexes[Symbol.iterator]();!(f=(y=d.next()).done);f=!0){var v=y.value;this.callbacks.stop(r,v)}}catch(t){h=!0,p=t}finally{try{!f&&d.return&&d.return()}finally{if(h)throw p}}}else if(this.source instanceof a.default){var b=!0,m=!1,g=void 0;try{for(var w,O=r.indexes[Symbol.iterator]();!(b=(w=O.next()).done);b=!0){var S=w.value;S!==t.REST&&this.source.stop(S,e),this.callbacks.stop(r,S)}}catch(t){m=!0,g=t}finally{try{!b&&O.return&&O.return()}finally{if(m)throw g}}}for(var A=0,k=this.timerids.length;A<k;A++)window.clearTimeout(this.timerids[A]),this.timerids[A]=null;return this}},{key:"get",value:function(t){var e=parseInt(t,10);return e>=0&&e<this.sequences.length?this.sequences[e]:this.sequences}},{key:"toggle",value:function(t,e,r){return this.isPaused()?this.start(t,e,r):this.stop(),this}},{key:"isSequences",value:function(){return Array.isArray(this.sequences[0])}},{key:"isPaused",value:function(){var t=!0,e=!1,r=void 0;try{for(var i,n=this.timerids[Symbol.iterator]();!(t=(i=n.next()).done);t=!0){var s=i.value;if(null!==s&&void 0!==s)return!1}}catch(t){e=!0,r=t}finally{try{!t&&n.return&&n.return()}finally{if(e)throw r}}return!0}},{key:"create",value:function(e){return"data:text/plain;base64,"+window.btoa(t.toAscii(String(e)))}},{key:"toString",value:function(){return"[MML]"}}]),t}();o.ONE_MINUTES=60,o.EQUAL_TEMPERAMENT=12,o.QUARTER_NOTE=4,o.REGEXP_MML=/\s*(?:T\d+)\s*|\s*(?:O\d+)\s*|\s*(?:(?:[CDEFGABR][#+-]?)+(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?)(?:&(?:[CDEFGABR][#+-]?)+(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?)*\s*/gi,o.REGEXP_TEMPO=/T\d+/i,o.REGEXP_OCTAVE=/O\d+/i,o.REGEXP_NOTE=/(?:(?:[CDEFGABR][#+-]?)+)(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)(?:&(?:[CDEFGABR][#+-]?)+(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?)*/i,o.REGEXP_CHORD=/((?:[CDEFGABR][#+-]?)+)(?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?.*/i,o.REGEXP_DURATION=/(?:[CDEFGABR][#+-]?)+((?:256|192|144|128|96|72|64|48|36|32|24|18|16|12|8|6|4|2|1)\.?.*)/i,o.REST="R",o.ERROR_STRING="MML",o.ERROR_TEMPO="TEMPO",o.ERROR_OCTAVE="OCTAVE",o.ERROR_NOTE="NOTE",o.computeIndex=function(t,e){var r=0;switch(e){case"C":r=3;break;case"D":r=5;break;case"E":r=7;break;case"F":r=8;break;case"G":r=10;break;case"A":r=12;break;case"B":r=14;break;case o.REST:return o.REST}var i=o.EQUAL_TEMPERAMENT*(t-1)+r;return i>=0?i:-1},o.computeFrequency=function(t){var e=Math.pow(2,1/12);return t>=0?27.5*Math.pow(e,t):-1},o.toAscii=function(t){for(var e="",r=0,i=t.length;r<i;r++){var n=t.charCodeAt(r);e+=n>255?"&#"+n+";":t.charAt(r)}return e},e.default=o},function(t,e,r){"use strict";function i(t,e,r,i,n){if("[object Object]"===Object.prototype.toString.call(arguments[0])){var s=arguments[0];"file"in s&&(t=s.file),"type"in s&&(e=s.type),"success"in s&&(r=s.success),"error"in s&&(i=s.error),"progress"in s&&(n=s.progress)}if(t instanceof Blob){var a=new FileReader;a.onprogress=function(t){"[object Function]"===Object.prototype.toString.call(n)&&n(t)},a.onerror=function(t){if("[object Function]"===Object.prototype.toString.call(i)){var e="";switch(a.error.code){case a.error.NOT_FOUND_ERR:e="NOT_FOUND_ERR";break;case a.error.SECURITY_ERR:e="SECURITY_ERR";break;case a.error.ABORT_ERR:e="ABORT_ERR";break;case a.error.NOT_READABLE_ERR:e="NOT_READABLE_ERR";break;case a.error.ENCODING_ERR:e="ENCODING_ERR";break;default:e="ERR"}i(t,e)}},a.onload=function(t){if("[object Function]"===Object.prototype.toString.call(r)){var e=a.result;"string"==typeof e&&-1===e.indexOf("data:")&&-1===e.indexOf("blob:")&&(e=e.replace(/<(\/?script.*?)>/gi,"&lt;$1&gt;")),r(t,e)}},/arraybuffer/i.test(e)?a.readAsArrayBuffer(t):/dataurl/i.test(e)?a.readAsDataURL(t):/text/i.test(e)&&a.readAsText(t,"UTF-8")}else"[object Function]"===Object.prototype.toString.call(i)&&i(null,"FILE_IS_NOT_BLOB")}Object.defineProperty(e,"__esModule",{value:!0}),e.read=i,e.file=function(t,e,r,n,s){if("[object Object]"===Object.prototype.toString.call(arguments[0])){var a=arguments[0];"event"in a&&(t=a.event),"type"in a&&(e=a.type),"success"in a&&(r=a.success),"error"in a&&(n=a.error),"progress"in a&&(s=a.progress)}if(t instanceof Event){var o=null;if("drop"===t.type)t.stopPropagation(),t.preventDefault(),o=t.dataTransfer.files[0];else{if(!("change"===t.type&&"files"in t.target))return;o=t.target.files[0]}if(o instanceof File){if(/text/i.test(e)&&-1===o.type.indexOf("text"))throw new Error("Please upload text file.");if(/arraybuffer|dataurl/i.test(e)&&!/audio|video/.test(o.type))throw new Error("Please upload audio or video file.");return i({file:o,type:e,success:r,error:n,progress:s}),o}throw new Error("Please upload file.")}},e.ajax=function(t,e,r,i,n){if("[object Object]"===Object.prototype.toString.call(arguments[0])){var s=arguments[0];"url"in s&&(t=s.url),"timeout"in s&&(e=s.timeout),"success"in s&&(r=s.success),"error"in s&&(i=s.error),"progress"in s&&(n=s.progress)}var a=new XMLHttpRequest,o=parseInt(e,10);a.timeout=o>0?o:6e4,a.ontimeout=function(t){"[object Function]"===Object.prototype.toString.call(i)&&i(t,"timeout")},a.onprogress=function(t){"[object Function]"===Object.prototype.toString.call(n)&&n(t)},a.onerror=function(t){"[object Function]"===Object.prototype.toString.call(i)&&i(t,"error")},a.onload=function(t){if(200===a.status){var e=a.response;e instanceof ArrayBuffer&&"[object Function]"===Object.prototype.toString.call(r)&&r(t,e)}},a.open("GET",t,!0),a.responseType="arraybuffer",a.send(null)},e.decode=function(t,e,r,i){if(t instanceof AudioContext&&e instanceof ArrayBuffer)return"[object Function]"!==Object.prototype.toString.call(r)&&(r=function(){}),"[object Function]"!==Object.prototype.toString.call(i)&&(i=function(){}),t.decodeAudioData(e,r,i)},e.toFrequencies=function(t){var e=Math.pow(2,1/12);Array.isArray(t)||(t=[t]);for(var r=new Array(t.length),i=0,n=t.length;i<n;i++){var s=parseInt(t[i],10);r[i]=s>=0?27.5*Math.pow(e,s):0}return r},e.convertTime=function(t){var e=parseFloat(t);if(e>=0)return{minutes:Math.floor(e/60),seconds:Math.floor(e%60),milliseconds:e-parseInt(e,10)}},e.fullscreen=function(t){if(t instanceof Element)if(t.webkitRequestFullscreen)t.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);else if(t.mozRequestFullScreen)t.mozRequestFullScreen();else if(t.msRequestFullscreen)t.msRequestFullscreen();else{if(!t.requestFullscreen)throw new Error("Cannot change to full screen.");t.requestFullscreen()}},e.exitFullscreen=function(){if(document.webkitCancelFullScreen)document.webkitCancelFullScreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else if(document.cancelFullScreen)document.cancelFullScreen();else{if(!document.exitFullscreen)throw new Error("Cannot exit from full screen.");document.exitFullscreen()}}}]);
//# sourceMappingURL=xsound.js.map